21f1152741a151f6db24ce2733195fc9
"use strict";
/**
 * TierEnforcer - Business Logic Tier Enforcement Engine
 *
 * MISSION-CRITICAL: Service layer for tier-based business logic enforcement
 * Complements UI tier enforcement with server-side validation and limits
 *
 * @see docs/implementation/tier-system/tier-boundaries-specification.md
 * @see docs/developer-guide/tier-implementation-checklist.md section 2.5
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.TierEnforcer = void 0;
const AirDuctCalculator_1 = __importDefault(require("../calculations/AirDuctCalculator"));
const SMACNAValidator_1 = __importDefault(require("../calculations/SMACNAValidator"));
/**
 * TierEnforcer - Business logic enforcement for tier boundaries
 * CRITICAL: Provides server-side validation to prevent tier circumvention
 */
class TierEnforcer {
    constructor(featureManager, dbManager) {
        this.featureManager = featureManager;
        this.dbManager = dbManager;
    }
    /**
     * Validate project creation limits
     */
    async validateProjectCreation(userId) {
        try {
            // Get user tier
            const userTier = await this.getUserTier(userId);
            const limits = TierEnforcer.TIER_LIMITS[userTier];
            // Check if unlimited projects allowed
            if (limits.maxProjects === -1) {
                return {
                    allowed: true,
                    currentTier: userTier
                };
            }
            // Count existing projects
            const projectCount = await this.getUserProjectCount(userId);
            if (projectCount >= limits.maxProjects) {
                return {
                    allowed: false,
                    reason: `Project limit reached (${projectCount}/${limits.maxProjects})`,
                    currentTier: userTier,
                    requiredTier: 'pro',
                    upgradeMessage: `Upgrade to Pro for unlimited projects`,
                    limitations: [`Free tier limited to ${limits.maxProjects} projects`]
                };
            }
            return {
                allowed: true,
                currentTier: userTier,
                limitations: [`${projectCount + 1}/${limits.maxProjects} projects used`]
            };
        }
        catch (error) {
            return {
                allowed: false,
                reason: `Validation error: ${error.message}`,
                currentTier: 'free'
            };
        }
    }
    /**
     * Validate project content limits (segments, rooms, equipment)
     */
    async validateProjectContent(userId, projectData) {
        try {
            const userTier = await this.getUserTier(userId);
            const limits = TierEnforcer.TIER_LIMITS[userTier];
            const violations = [];
            const limitations = [];
            // Check segment count
            const segmentCount = projectData.segments?.length || 0;
            if (limits.maxSegmentsPerProject !== -1 && segmentCount > limits.maxSegmentsPerProject) {
                violations.push(`Too many segments (${segmentCount}/${limits.maxSegmentsPerProject})`);
            }
            else if (limits.maxSegmentsPerProject !== -1) {
                limitations.push(`${segmentCount}/${limits.maxSegmentsPerProject} segments used`);
            }
            // Check room count
            const roomCount = projectData.rooms?.length || 0;
            if (limits.maxRoomsPerProject !== -1 && roomCount > limits.maxRoomsPerProject) {
                violations.push(`Too many rooms (${roomCount}/${limits.maxRoomsPerProject})`);
            }
            else if (limits.maxRoomsPerProject !== -1) {
                limitations.push(`${roomCount}/${limits.maxRoomsPerProject} rooms used`);
            }
            // Check equipment count
            const equipmentCount = projectData.equipment?.length || 0;
            if (limits.maxEquipmentPerProject !== -1 && equipmentCount > limits.maxEquipmentPerProject) {
                violations.push(`Too many equipment items (${equipmentCount}/${limits.maxEquipmentPerProject})`);
            }
            else if (limits.maxEquipmentPerProject !== -1) {
                limitations.push(`${equipmentCount}/${limits.maxEquipmentPerProject} equipment items used`);
            }
            if (violations.length > 0) {
                return {
                    allowed: false,
                    reason: violations.join(', '),
                    currentTier: userTier,
                    requiredTier: userTier === 'free' ? 'pro' : 'enterprise',
                    upgradeMessage: `Upgrade to ${userTier === 'free' ? 'Pro' : 'Enterprise'} for higher limits`,
                    limitations: violations
                };
            }
            return {
                allowed: true,
                currentTier: userTier,
                limitations
            };
        }
        catch (error) {
            return {
                allowed: false,
                reason: `Validation error: ${error.message}`,
                currentTier: 'free'
            };
        }
    }
    /**
     * Validate export access and format
     */
    async validateExportAccess(userId, formatId, resolution) {
        try {
            const userTier = await this.getUserTier(userId);
            const limits = TierEnforcer.TIER_LIMITS[userTier];
            const format = TierEnforcer.EXPORT_FORMATS[formatId];
            if (!format) {
                return {
                    allowed: false,
                    reason: `Unknown export format: ${formatId}`,
                    currentTier: userTier
                };
            }
            // Check if format is allowed for user tier
            if (!limits.allowedExportFormats.includes(formatId)) {
                return {
                    allowed: false,
                    reason: `Export format '${format.name}' requires ${format.requiredTier} tier`,
                    currentTier: userTier,
                    requiredTier: format.requiredTier,
                    upgradeMessage: `Upgrade to ${format.requiredTier} for ${format.name} export`,
                    limitations: [`Available formats: ${limits.allowedExportFormats.join(', ')}`]
                };
            }
            // Check resolution limits
            if (resolution && resolution > limits.maxExportResolution) {
                // Determine required tier based on resolution
                let requiredTier = 'free';
                if (resolution > 4320) {
                    requiredTier = 'enterprise';
                }
                else if (resolution > 1080) {
                    requiredTier = 'pro';
                }
                return {
                    allowed: false,
                    reason: `Resolution ${resolution}p exceeds tier limit of ${limits.maxExportResolution}p`,
                    currentTier: userTier,
                    requiredTier,
                    upgradeMessage: `Upgrade for higher resolution exports`,
                    limitations: [`Maximum resolution: ${limits.maxExportResolution}p`]
                };
            }
            // Check feature flag
            const featureEnabled = await this.featureManager.isEnabled(format.featureName, userId);
            if (!featureEnabled.enabled) {
                return {
                    allowed: false,
                    reason: `Feature '${format.featureName}' not enabled for user`,
                    currentTier: userTier,
                    requiredTier: format.requiredTier
                };
            }
            return {
                allowed: true,
                currentTier: userTier,
                limitations: limits.watermarkedExports ? ['Exports will include watermark'] : []
            };
        }
        catch (error) {
            return {
                allowed: false,
                reason: `Validation error: ${error.message}`,
                currentTier: 'free'
            };
        }
    }
    /**
     * Assess calculation complexity and validate tier access
     */
    async validateCalculationAccess(userId, inputs, projectData) {
        try {
            const userTier = await this.getUserTier(userId);
            const limits = TierEnforcer.TIER_LIMITS[userTier];
            // Assess calculation complexity
            const complexity = this.assessCalculationComplexity(inputs, projectData);
            // Check if user tier supports this complexity level
            const complexityLevels = ['basic', 'intermediate', 'advanced', 'expert'];
            const userMaxLevel = complexityLevels.indexOf(limits.maxCalculationComplexity);
            const requiredLevel = complexityLevels.indexOf(complexity.level);
            if (requiredLevel > userMaxLevel) {
                return {
                    allowed: false,
                    reason: `Calculation complexity '${complexity.level}' requires ${complexity.requiredTier} tier`,
                    currentTier: userTier,
                    requiredTier: complexity.requiredTier,
                    upgradeMessage: `Upgrade to ${complexity.requiredTier} for advanced calculations`,
                    limitations: [`Current tier supports: ${limits.maxCalculationComplexity} calculations`]
                };
            }
            return {
                allowed: true,
                currentTier: userTier,
                limitations: [`Calculation complexity: ${complexity.level} (score: ${complexity.score})`]
            };
        }
        catch (error) {
            return {
                allowed: false,
                reason: `Validation error: ${error.message}`,
                currentTier: 'free'
            };
        }
    }
    /**
     * Validate feature access
     */
    async validateFeatureAccess(userId, featureName) {
        try {
            const userTier = await this.getUserTier(userId);
            const limits = TierEnforcer.TIER_LIMITS[userTier];
            // Check feature flag
            const featureResult = await this.featureManager.isEnabled(featureName, userId);
            if (!featureResult.enabled) {
                // Determine required tier for this feature
                let requiredTier = 'pro';
                for (const [tier, tierLimits] of Object.entries(TierEnforcer.TIER_LIMITS)) {
                    if (tierLimits.advancedFeatures.includes(featureName)) {
                        requiredTier = tier;
                        break;
                    }
                }
                return {
                    allowed: false,
                    reason: featureResult.reason || `Feature '${featureName}' not available`,
                    currentTier: userTier,
                    requiredTier,
                    upgradeMessage: `Upgrade to ${requiredTier} for ${featureName}`,
                    limitations: [`Available features: ${limits.advancedFeatures.join(', ') || 'Basic features only'}`]
                };
            }
            return {
                allowed: true,
                currentTier: userTier
            };
        }
        catch (error) {
            return {
                allowed: false,
                reason: `Validation error: ${error.message}`,
                currentTier: 'free'
            };
        }
    }
    /**
     * Validate generic file access based on tier (read/write)
     * Non-destructive additive method to align with Electron FileManager usage
     */
    async validateFileAccess(userId, mode) {
        try {
            const userTier = await this.getUserTier(userId);
            // For now, allow both read and write for free tier, align with feature flags later
            return { allowed: true, currentTier: userTier };
        }
        catch (error) {
            return { allowed: false, currentTier: 'free', reason: `Validation error: ${error.message}` };
        }
    }
    /**
     * Validate import access based on file extension and size
     * Aligns with FileManager.importProject usage; uses export limits heuristically
     */
    async validateImportAccess(userId, extension, sizeBytes) {
        try {
            const userTier = await this.getUserTier(userId);
            const limits = TierEnforcer.TIER_LIMITS[userTier];
            // Basic size gating similar to FileManager
            const sizeLimit = userTier === 'free' ? 10 * 1024 * 1024 : userTier === 'pro' ? 100 * 1024 * 1024 : 1024 * 1024 * 1024;
            if (sizeBytes && sizeBytes > sizeLimit) {
                return {
                    allowed: false,
                    currentTier: userTier,
                    reason: `Import size exceeds tier limit`,
                    requiredTier: sizeBytes > 100 * 1024 * 1024 ? 'enterprise' : 'pro'
                };
            }
            return { allowed: true, currentTier: userTier };
        }
        catch (error) {
            return { allowed: false, currentTier: 'free', reason: `Validation error: ${error.message}` };
        }
    }
    /**
     * Perform calculation with tier enforcement
     */
    async performCalculation(userId, inputs, projectData) {
        // Validate calculation access
        const enforcement = await this.validateCalculationAccess(userId, inputs, projectData);
        if (!enforcement.allowed) {
            return { enforcement };
        }
        try {
            // Perform calculation using extracted core logic
            const result = AirDuctCalculator_1.default.calculateDuctSizing(inputs);
            // Validate against standards
            const calculationData = {
                velocity: result.velocity,
                frictionRate: inputs.frictionRate,
                ductType: inputs.ductType,
                airflow: inputs.airflow,
                diameter: result.diameter,
                width: result.width,
                height: result.height,
                aspectRatio: result.aspectRatio,
                area: result.area,
                material: inputs.material
            };
            const validation = SMACNAValidator_1.default.validateSMACNACompliance(calculationData);
            return {
                result,
                validation,
                enforcement
            };
        }
        catch (error) {
            return {
                enforcement: {
                    allowed: false,
                    reason: `Calculation error: ${error.message}`,
                    currentTier: enforcement.currentTier
                }
            };
        }
    }
    /**
     * Assess calculation complexity based on inputs and project data
     */
    assessCalculationComplexity(inputs, projectData) {
        let score = 0;
        const factors = {
            segmentCount: projectData?.segments?.length || 1,
            roomCount: projectData?.rooms?.length || 1,
            equipmentCount: projectData?.equipment?.length || 1,
            customMaterials: inputs.material && inputs.material !== 'galvanized_steel' ? 1 : 0,
            advancedFeatures: 0
        };
        // Score based on project size
        score += Math.min(factors.segmentCount * 2, 20);
        score += Math.min(factors.roomCount * 3, 15);
        score += Math.min(factors.equipmentCount * 4, 20);
        // Score based on calculation parameters
        if (inputs.frictionRate > 0.12)
            score += 10; // High friction rate
        if (inputs.targetVelocity && inputs.targetVelocity > 2000)
            score += 10; // High velocity
        if (inputs.ductType === 'rectangular')
            score += 5; // More complex than round
        // Score based on custom materials
        score += factors.customMaterials * 10;
        // Determine complexity level and required tier
        let level;
        let requiredTier;
        if (score <= 25) {
            level = 'basic';
            requiredTier = 'free';
        }
        else if (score <= 50) {
            level = 'intermediate';
            requiredTier = 'pro';
        }
        else if (score <= 75) {
            level = 'advanced';
            requiredTier = 'pro';
        }
        else {
            level = 'expert';
            requiredTier = 'enterprise';
        }
        return {
            level,
            score: Math.min(score, 100),
            factors,
            requiredTier
        };
    }
    /**
     * Get user tier from feature manager
     */
    async getUserTier(userId) {
        try {
            // Get user from database through feature manager
            const userRepo = this.featureManager['userRepository'];
            const user = await userRepo.getUser(userId);
            return user?.tier || 'free';
        }
        catch (error) {
            console.error('Error getting user tier:', error);
            return 'free'; // Default to free tier on error
        }
    }
    /**
     * Get user project count
     * TODO: Implement actual project count query when project repository is available
     */
    async getUserProjectCount(userId) {
        // This would typically query the projects table through a repository
        // For now, return 0 as placeholder until project repository is implemented
        return Promise.resolve(0);
    }
    /**
     * Get tier limits for a specific tier
     */
    static getTierLimits(tier) {
        return { ...TierEnforcer.TIER_LIMITS[tier] };
    }
    /**
     * Get all export formats
     */
    static getExportFormats() {
        return { ...TierEnforcer.EXPORT_FORMATS };
    }
    /**
     * Get export formats available for a tier
     */
    static getAvailableExportFormats(tier) {
        const limits = TierEnforcer.TIER_LIMITS[tier];
        return limits.allowedExportFormats.map(id => TierEnforcer.EXPORT_FORMATS[id]).filter(Boolean);
    }
}
exports.TierEnforcer = TierEnforcer;
// Tier limits configuration
TierEnforcer.TIER_LIMITS = {
    free: {
        maxProjects: 3,
        maxSegmentsPerProject: 10,
        maxRoomsPerProject: 5,
        maxEquipmentPerProject: 3,
        maxCalculationComplexity: 'basic',
        allowedExportFormats: ['pdf', 'json'],
        maxExportResolution: 1080,
        watermarkedExports: true,
        advancedFeatures: []
    },
    pro: {
        maxProjects: -1, // Unlimited
        maxSegmentsPerProject: 100,
        maxRoomsPerProject: 50,
        maxEquipmentPerProject: 25,
        maxCalculationComplexity: 'advanced',
        allowedExportFormats: ['pdf', 'json', 'png', 'excel'],
        maxExportResolution: 4320, // 4K
        watermarkedExports: false,
        advancedFeatures: ['unlimited_segments', 'equipment_selection', 'high_res_pdf_export', 'enhanced_csv_export']
    },
    enterprise: {
        maxProjects: -1, // Unlimited
        maxSegmentsPerProject: -1, // Unlimited
        maxRoomsPerProject: -1, // Unlimited
        maxEquipmentPerProject: -1, // Unlimited
        maxCalculationComplexity: 'expert',
        allowedExportFormats: ['pdf', 'json', 'png', 'excel', 'dwg', 'ifc'],
        maxExportResolution: 8640, // 8K
        watermarkedExports: false,
        advancedFeatures: ['unlimited_segments', 'equipment_selection', 'high_res_pdf_export', 'enhanced_csv_export', 'cad_export', 'api_access', 'bulk_operations']
    }
};
// Export format definitions
TierEnforcer.EXPORT_FORMATS = {
    pdf: {
        id: 'pdf',
        name: 'PDF Report',
        description: 'Complete project report with BOM and schedules',
        requiredTier: 'free',
        featureName: 'air_duct_sizer'
    },
    json: {
        id: 'json',
        name: 'JSON Data',
        description: 'Project data for backup or sharing',
        requiredTier: 'free',
        featureName: 'air_duct_sizer'
    },
    png: {
        id: 'png',
        name: 'PNG Image',
        description: 'High-resolution drawing export',
        requiredTier: 'pro',
        featureName: 'high_res_pdf_export',
        maxResolution: 4320
    },
    excel: {
        id: 'excel',
        name: 'Excel Spreadsheet',
        description: 'BOM and schedules in spreadsheet format',
        requiredTier: 'pro',
        featureName: 'enhanced_csv_export'
    },
    dwg: {
        id: 'dwg',
        name: 'AutoCAD Drawing',
        description: 'CAD-compatible drawing file',
        requiredTier: 'enterprise',
        featureName: 'cad_export'
    },
    ifc: {
        id: 'ifc',
        name: 'IFC Model',
        description: 'Building Information Model format',
        requiredTier: 'enterprise',
        featureName: 'cad_export'
    }
};
exports.default = TierEnforcer;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2pvaG5yZXlyYXpvbmFibGUvRG9jdW1lbnRzL1NpemVXaXNlX1N1aXRlX0FwcC9iYWNrZW5kL3NlcnZpY2VzL2VuZm9yY2VtZW50L1RpZXJFbmZvcmNlci50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7O0dBUUc7Ozs7OztBQUlILDBGQUEyRztBQUMzRyxzRkFBcUc7QUErRXJHOzs7R0FHRztBQUNILE1BQWEsWUFBWTtJQXdGdkIsWUFBWSxjQUE4QixFQUFFLFNBQTBCO1FBQ3BFLElBQUksQ0FBQyxjQUFjLEdBQUcsY0FBYyxDQUFDO1FBQ3JDLElBQUksQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDO0lBQzdCLENBQUM7SUFFRDs7T0FFRztJQUNJLEtBQUssQ0FBQyx1QkFBdUIsQ0FBQyxNQUFjO1FBQ2pELElBQUksQ0FBQztZQUNILGdCQUFnQjtZQUNoQixNQUFNLFFBQVEsR0FBRyxNQUFNLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDaEQsTUFBTSxNQUFNLEdBQUcsWUFBWSxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUVsRCxzQ0FBc0M7WUFDdEMsSUFBSSxNQUFNLENBQUMsV0FBVyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUM7Z0JBQzlCLE9BQU87b0JBQ0wsT0FBTyxFQUFFLElBQUk7b0JBQ2IsV0FBVyxFQUFFLFFBQVE7aUJBQ3RCLENBQUM7WUFDSixDQUFDO1lBRUQsMEJBQTBCO1lBQzFCLE1BQU0sWUFBWSxHQUFHLE1BQU0sSUFBSSxDQUFDLG1CQUFtQixDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBRTVELElBQUksWUFBWSxJQUFJLE1BQU0sQ0FBQyxXQUFXLEVBQUUsQ0FBQztnQkFDdkMsT0FBTztvQkFDTCxPQUFPLEVBQUUsS0FBSztvQkFDZCxNQUFNLEVBQUUsMEJBQTBCLFlBQVksSUFBSSxNQUFNLENBQUMsV0FBVyxHQUFHO29CQUN2RSxXQUFXLEVBQUUsUUFBUTtvQkFDckIsWUFBWSxFQUFFLEtBQUs7b0JBQ25CLGNBQWMsRUFBRSx1Q0FBdUM7b0JBQ3ZELFdBQVcsRUFBRSxDQUFDLHdCQUF3QixNQUFNLENBQUMsV0FBVyxXQUFXLENBQUM7aUJBQ3JFLENBQUM7WUFDSixDQUFDO1lBRUQsT0FBTztnQkFDTCxPQUFPLEVBQUUsSUFBSTtnQkFDYixXQUFXLEVBQUUsUUFBUTtnQkFDckIsV0FBVyxFQUFFLENBQUMsR0FBRyxZQUFZLEdBQUcsQ0FBQyxJQUFJLE1BQU0sQ0FBQyxXQUFXLGdCQUFnQixDQUFDO2FBQ3pFLENBQUM7UUFFSixDQUFDO1FBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztZQUNmLE9BQU87Z0JBQ0wsT0FBTyxFQUFFLEtBQUs7Z0JBQ2QsTUFBTSxFQUFFLHFCQUFxQixLQUFLLENBQUMsT0FBTyxFQUFFO2dCQUM1QyxXQUFXLEVBQUUsTUFBTTthQUNwQixDQUFDO1FBQ0osQ0FBQztJQUNILENBQUM7SUFFRDs7T0FFRztJQUNJLEtBQUssQ0FBQyxzQkFBc0IsQ0FBQyxNQUFjLEVBQUUsV0FBaUM7UUFDbkYsSUFBSSxDQUFDO1lBQ0gsTUFBTSxRQUFRLEdBQUcsTUFBTSxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ2hELE1BQU0sTUFBTSxHQUFHLFlBQVksQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUM7WUFFbEQsTUFBTSxVQUFVLEdBQWEsRUFBRSxDQUFDO1lBQ2hDLE1BQU0sV0FBVyxHQUFhLEVBQUUsQ0FBQztZQUVqQyxzQkFBc0I7WUFDdEIsTUFBTSxZQUFZLEdBQUcsV0FBVyxDQUFDLFFBQVEsRUFBRSxNQUFNLElBQUksQ0FBQyxDQUFDO1lBQ3ZELElBQUksTUFBTSxDQUFDLHFCQUFxQixLQUFLLENBQUMsQ0FBQyxJQUFJLFlBQVksR0FBRyxNQUFNLENBQUMscUJBQXFCLEVBQUUsQ0FBQztnQkFDdkYsVUFBVSxDQUFDLElBQUksQ0FBQyxzQkFBc0IsWUFBWSxJQUFJLE1BQU0sQ0FBQyxxQkFBcUIsR0FBRyxDQUFDLENBQUM7WUFDekYsQ0FBQztpQkFBTSxJQUFJLE1BQU0sQ0FBQyxxQkFBcUIsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDO2dCQUMvQyxXQUFXLENBQUMsSUFBSSxDQUFDLEdBQUcsWUFBWSxJQUFJLE1BQU0sQ0FBQyxxQkFBcUIsZ0JBQWdCLENBQUMsQ0FBQztZQUNwRixDQUFDO1lBRUQsbUJBQW1CO1lBQ25CLE1BQU0sU0FBUyxHQUFHLFdBQVcsQ0FBQyxLQUFLLEVBQUUsTUFBTSxJQUFJLENBQUMsQ0FBQztZQUNqRCxJQUFJLE1BQU0sQ0FBQyxrQkFBa0IsS0FBSyxDQUFDLENBQUMsSUFBSSxTQUFTLEdBQUcsTUFBTSxDQUFDLGtCQUFrQixFQUFFLENBQUM7Z0JBQzlFLFVBQVUsQ0FBQyxJQUFJLENBQUMsbUJBQW1CLFNBQVMsSUFBSSxNQUFNLENBQUMsa0JBQWtCLEdBQUcsQ0FBQyxDQUFDO1lBQ2hGLENBQUM7aUJBQU0sSUFBSSxNQUFNLENBQUMsa0JBQWtCLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQztnQkFDNUMsV0FBVyxDQUFDLElBQUksQ0FBQyxHQUFHLFNBQVMsSUFBSSxNQUFNLENBQUMsa0JBQWtCLGFBQWEsQ0FBQyxDQUFDO1lBQzNFLENBQUM7WUFFRCx3QkFBd0I7WUFDeEIsTUFBTSxjQUFjLEdBQUcsV0FBVyxDQUFDLFNBQVMsRUFBRSxNQUFNLElBQUksQ0FBQyxDQUFDO1lBQzFELElBQUksTUFBTSxDQUFDLHNCQUFzQixLQUFLLENBQUMsQ0FBQyxJQUFJLGNBQWMsR0FBRyxNQUFNLENBQUMsc0JBQXNCLEVBQUUsQ0FBQztnQkFDM0YsVUFBVSxDQUFDLElBQUksQ0FBQyw2QkFBNkIsY0FBYyxJQUFJLE1BQU0sQ0FBQyxzQkFBc0IsR0FBRyxDQUFDLENBQUM7WUFDbkcsQ0FBQztpQkFBTSxJQUFJLE1BQU0sQ0FBQyxzQkFBc0IsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDO2dCQUNoRCxXQUFXLENBQUMsSUFBSSxDQUFDLEdBQUcsY0FBYyxJQUFJLE1BQU0sQ0FBQyxzQkFBc0IsdUJBQXVCLENBQUMsQ0FBQztZQUM5RixDQUFDO1lBRUQsSUFBSSxVQUFVLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRSxDQUFDO2dCQUMxQixPQUFPO29CQUNMLE9BQU8sRUFBRSxLQUFLO29CQUNkLE1BQU0sRUFBRSxVQUFVLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQztvQkFDN0IsV0FBVyxFQUFFLFFBQVE7b0JBQ3JCLFlBQVksRUFBRSxRQUFRLEtBQUssTUFBTSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLFlBQVk7b0JBQ3hELGNBQWMsRUFBRSxjQUFjLFFBQVEsS0FBSyxNQUFNLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsWUFBWSxvQkFBb0I7b0JBQzVGLFdBQVcsRUFBRSxVQUFVO2lCQUN4QixDQUFDO1lBQ0osQ0FBQztZQUVELE9BQU87Z0JBQ0wsT0FBTyxFQUFFLElBQUk7Z0JBQ2IsV0FBVyxFQUFFLFFBQVE7Z0JBQ3JCLFdBQVc7YUFDWixDQUFDO1FBRUosQ0FBQztRQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7WUFDZixPQUFPO2dCQUNMLE9BQU8sRUFBRSxLQUFLO2dCQUNkLE1BQU0sRUFBRSxxQkFBcUIsS0FBSyxDQUFDLE9BQU8sRUFBRTtnQkFDNUMsV0FBVyxFQUFFLE1BQU07YUFDcEIsQ0FBQztRQUNKLENBQUM7SUFDSCxDQUFDO0lBRUQ7O09BRUc7SUFDSSxLQUFLLENBQUMsb0JBQW9CLENBQUMsTUFBYyxFQUFFLFFBQWdCLEVBQUUsVUFBbUI7UUFDckYsSUFBSSxDQUFDO1lBQ0gsTUFBTSxRQUFRLEdBQUcsTUFBTSxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ2hELE1BQU0sTUFBTSxHQUFHLFlBQVksQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDbEQsTUFBTSxNQUFNLEdBQUcsWUFBWSxDQUFDLGNBQWMsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUVyRCxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7Z0JBQ1osT0FBTztvQkFDTCxPQUFPLEVBQUUsS0FBSztvQkFDZCxNQUFNLEVBQUUsMEJBQTBCLFFBQVEsRUFBRTtvQkFDNUMsV0FBVyxFQUFFLFFBQVE7aUJBQ3RCLENBQUM7WUFDSixDQUFDO1lBRUQsMkNBQTJDO1lBQzNDLElBQUksQ0FBQyxNQUFNLENBQUMsb0JBQW9CLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUM7Z0JBQ3BELE9BQU87b0JBQ0wsT0FBTyxFQUFFLEtBQUs7b0JBQ2QsTUFBTSxFQUFFLGtCQUFrQixNQUFNLENBQUMsSUFBSSxjQUFjLE1BQU0sQ0FBQyxZQUFZLE9BQU87b0JBQzdFLFdBQVcsRUFBRSxRQUFRO29CQUNyQixZQUFZLEVBQUUsTUFBTSxDQUFDLFlBQVk7b0JBQ2pDLGNBQWMsRUFBRSxjQUFjLE1BQU0sQ0FBQyxZQUFZLFFBQVEsTUFBTSxDQUFDLElBQUksU0FBUztvQkFDN0UsV0FBVyxFQUFFLENBQUMsc0JBQXNCLE1BQU0sQ0FBQyxvQkFBb0IsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQztpQkFDOUUsQ0FBQztZQUNKLENBQUM7WUFFRCwwQkFBMEI7WUFDMUIsSUFBSSxVQUFVLElBQUksVUFBVSxHQUFHLE1BQU0sQ0FBQyxtQkFBbUIsRUFBRSxDQUFDO2dCQUMxRCw4Q0FBOEM7Z0JBQzlDLElBQUksWUFBWSxHQUFhLE1BQU0sQ0FBQztnQkFDcEMsSUFBSSxVQUFVLEdBQUcsSUFBSSxFQUFFLENBQUM7b0JBQ3RCLFlBQVksR0FBRyxZQUFZLENBQUM7Z0JBQzlCLENBQUM7cUJBQU0sSUFBSSxVQUFVLEdBQUcsSUFBSSxFQUFFLENBQUM7b0JBQzdCLFlBQVksR0FBRyxLQUFLLENBQUM7Z0JBQ3ZCLENBQUM7Z0JBRUQsT0FBTztvQkFDTCxPQUFPLEVBQUUsS0FBSztvQkFDZCxNQUFNLEVBQUUsY0FBYyxVQUFVLDJCQUEyQixNQUFNLENBQUMsbUJBQW1CLEdBQUc7b0JBQ3hGLFdBQVcsRUFBRSxRQUFRO29CQUNyQixZQUFZO29CQUNaLGNBQWMsRUFBRSx1Q0FBdUM7b0JBQ3ZELFdBQVcsRUFBRSxDQUFDLHVCQUF1QixNQUFNLENBQUMsbUJBQW1CLEdBQUcsQ0FBQztpQkFDcEUsQ0FBQztZQUNKLENBQUM7WUFFRCxxQkFBcUI7WUFDckIsTUFBTSxjQUFjLEdBQUcsTUFBTSxJQUFJLENBQUMsY0FBYyxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsV0FBVyxFQUFFLE1BQU0sQ0FBQyxDQUFDO1lBQ3ZGLElBQUksQ0FBQyxjQUFjLENBQUMsT0FBTyxFQUFFLENBQUM7Z0JBQzVCLE9BQU87b0JBQ0wsT0FBTyxFQUFFLEtBQUs7b0JBQ2QsTUFBTSxFQUFFLFlBQVksTUFBTSxDQUFDLFdBQVcsd0JBQXdCO29CQUM5RCxXQUFXLEVBQUUsUUFBUTtvQkFDckIsWUFBWSxFQUFFLE1BQU0sQ0FBQyxZQUFZO2lCQUNsQyxDQUFDO1lBQ0osQ0FBQztZQUVELE9BQU87Z0JBQ0wsT0FBTyxFQUFFLElBQUk7Z0JBQ2IsV0FBVyxFQUFFLFFBQVE7Z0JBQ3JCLFdBQVcsRUFBRSxNQUFNLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxDQUFDLENBQUMsZ0NBQWdDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRTthQUNqRixDQUFDO1FBRUosQ0FBQztRQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7WUFDZixPQUFPO2dCQUNMLE9BQU8sRUFBRSxLQUFLO2dCQUNkLE1BQU0sRUFBRSxxQkFBcUIsS0FBSyxDQUFDLE9BQU8sRUFBRTtnQkFDNUMsV0FBVyxFQUFFLE1BQU07YUFDcEIsQ0FBQztRQUNKLENBQUM7SUFDSCxDQUFDO0lBRUQ7O09BRUc7SUFDSSxLQUFLLENBQUMseUJBQXlCLENBQUMsTUFBYyxFQUFFLE1BQXdCLEVBQUUsV0FBa0M7UUFDakgsSUFBSSxDQUFDO1lBQ0gsTUFBTSxRQUFRLEdBQUcsTUFBTSxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ2hELE1BQU0sTUFBTSxHQUFHLFlBQVksQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUM7WUFFbEQsZ0NBQWdDO1lBQ2hDLE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQywyQkFBMkIsQ0FBQyxNQUFNLEVBQUUsV0FBVyxDQUFDLENBQUM7WUFFekUsb0RBQW9EO1lBQ3BELE1BQU0sZ0JBQWdCLEdBQUcsQ0FBQyxPQUFPLEVBQUUsY0FBYyxFQUFFLFVBQVUsRUFBRSxRQUFRLENBQUMsQ0FBQztZQUN6RSxNQUFNLFlBQVksR0FBRyxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLHdCQUF3QixDQUFDLENBQUM7WUFDL0UsTUFBTSxhQUFhLEdBQUcsZ0JBQWdCLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUVqRSxJQUFJLGFBQWEsR0FBRyxZQUFZLEVBQUUsQ0FBQztnQkFDakMsT0FBTztvQkFDTCxPQUFPLEVBQUUsS0FBSztvQkFDZCxNQUFNLEVBQUUsMkJBQTJCLFVBQVUsQ0FBQyxLQUFLLGNBQWMsVUFBVSxDQUFDLFlBQVksT0FBTztvQkFDL0YsV0FBVyxFQUFFLFFBQVE7b0JBQ3JCLFlBQVksRUFBRSxVQUFVLENBQUMsWUFBWTtvQkFDckMsY0FBYyxFQUFFLGNBQWMsVUFBVSxDQUFDLFlBQVksNEJBQTRCO29CQUNqRixXQUFXLEVBQUUsQ0FBQywwQkFBMEIsTUFBTSxDQUFDLHdCQUF3QixlQUFlLENBQUM7aUJBQ3hGLENBQUM7WUFDSixDQUFDO1lBRUQsT0FBTztnQkFDTCxPQUFPLEVBQUUsSUFBSTtnQkFDYixXQUFXLEVBQUUsUUFBUTtnQkFDckIsV0FBVyxFQUFFLENBQUMsMkJBQTJCLFVBQVUsQ0FBQyxLQUFLLFlBQVksVUFBVSxDQUFDLEtBQUssR0FBRyxDQUFDO2FBQzFGLENBQUM7UUFFSixDQUFDO1FBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztZQUNmLE9BQU87Z0JBQ0wsT0FBTyxFQUFFLEtBQUs7Z0JBQ2QsTUFBTSxFQUFFLHFCQUFxQixLQUFLLENBQUMsT0FBTyxFQUFFO2dCQUM1QyxXQUFXLEVBQUUsTUFBTTthQUNwQixDQUFDO1FBQ0osQ0FBQztJQUNILENBQUM7SUFFRDs7T0FFRztJQUNJLEtBQUssQ0FBQyxxQkFBcUIsQ0FBQyxNQUFjLEVBQUUsV0FBbUI7UUFDcEUsSUFBSSxDQUFDO1lBQ0gsTUFBTSxRQUFRLEdBQUcsTUFBTSxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ2hELE1BQU0sTUFBTSxHQUFHLFlBQVksQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUM7WUFFbEQscUJBQXFCO1lBQ3JCLE1BQU0sYUFBYSxHQUFHLE1BQU0sSUFBSSxDQUFDLGNBQWMsQ0FBQyxTQUFTLENBQUMsV0FBVyxFQUFFLE1BQU0sQ0FBQyxDQUFDO1lBRS9FLElBQUksQ0FBQyxhQUFhLENBQUMsT0FBTyxFQUFFLENBQUM7Z0JBQzNCLDJDQUEyQztnQkFDM0MsSUFBSSxZQUFZLEdBQWEsS0FBSyxDQUFDO2dCQUNuQyxLQUFLLE1BQU0sQ0FBQyxJQUFJLEVBQUUsVUFBVSxDQUFDLElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQztvQkFDMUUsSUFBSSxVQUFVLENBQUMsZ0JBQWdCLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxFQUFFLENBQUM7d0JBQ3RELFlBQVksR0FBRyxJQUFnQixDQUFDO3dCQUNoQyxNQUFNO29CQUNSLENBQUM7Z0JBQ0gsQ0FBQztnQkFFRCxPQUFPO29CQUNMLE9BQU8sRUFBRSxLQUFLO29CQUNkLE1BQU0sRUFBRSxhQUFhLENBQUMsTUFBTSxJQUFJLFlBQVksV0FBVyxpQkFBaUI7b0JBQ3hFLFdBQVcsRUFBRSxRQUFRO29CQUNyQixZQUFZO29CQUNaLGNBQWMsRUFBRSxjQUFjLFlBQVksUUFBUSxXQUFXLEVBQUU7b0JBQy9ELFdBQVcsRUFBRSxDQUFDLHVCQUF1QixNQUFNLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLHFCQUFxQixFQUFFLENBQUM7aUJBQ3BHLENBQUM7WUFDSixDQUFDO1lBRUQsT0FBTztnQkFDTCxPQUFPLEVBQUUsSUFBSTtnQkFDYixXQUFXLEVBQUUsUUFBUTthQUN0QixDQUFDO1FBRUosQ0FBQztRQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7WUFDZixPQUFPO2dCQUNMLE9BQU8sRUFBRSxLQUFLO2dCQUNkLE1BQU0sRUFBRSxxQkFBcUIsS0FBSyxDQUFDLE9BQU8sRUFBRTtnQkFDNUMsV0FBVyxFQUFFLE1BQU07YUFDcEIsQ0FBQztRQUNKLENBQUM7SUFDSCxDQUFDO0lBR0Q7OztPQUdHO0lBQ0ksS0FBSyxDQUFDLGtCQUFrQixDQUFDLE1BQWMsRUFBRSxJQUFzQjtRQUNwRSxJQUFJLENBQUM7WUFDSCxNQUFNLFFBQVEsR0FBRyxNQUFNLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDaEQsbUZBQW1GO1lBQ25GLE9BQU8sRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLFdBQVcsRUFBRSxRQUFRLEVBQUUsQ0FBQztRQUNsRCxDQUFDO1FBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztZQUNmLE9BQU8sRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFLFdBQVcsRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLHFCQUFxQixLQUFLLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQztRQUMvRixDQUFDO0lBQ0gsQ0FBQztJQUVEOzs7T0FHRztJQUNJLEtBQUssQ0FBQyxvQkFBb0IsQ0FBQyxNQUFjLEVBQUUsU0FBaUIsRUFBRSxTQUFrQjtRQUNyRixJQUFJLENBQUM7WUFDSCxNQUFNLFFBQVEsR0FBRyxNQUFNLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDaEQsTUFBTSxNQUFNLEdBQUcsWUFBWSxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUNsRCwyQ0FBMkM7WUFDM0MsTUFBTSxTQUFTLEdBQUcsUUFBUSxLQUFLLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxHQUFHLElBQUksR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLFFBQVEsS0FBSyxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxJQUFJLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLEdBQUcsSUFBSSxHQUFHLElBQUksQ0FBQztZQUN2SCxJQUFJLFNBQVMsSUFBSSxTQUFTLEdBQUcsU0FBUyxFQUFFLENBQUM7Z0JBQ3ZDLE9BQU87b0JBQ0wsT0FBTyxFQUFFLEtBQUs7b0JBQ2QsV0FBVyxFQUFFLFFBQVE7b0JBQ3JCLE1BQU0sRUFBRSxnQ0FBZ0M7b0JBQ3hDLFlBQVksRUFBRSxTQUFTLEdBQUcsR0FBRyxHQUFHLElBQUksR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsS0FBSztpQkFDbkUsQ0FBQztZQUNKLENBQUM7WUFDRCxPQUFPLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxXQUFXLEVBQUUsUUFBUSxFQUFFLENBQUM7UUFDbEQsQ0FBQztRQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7WUFDZixPQUFPLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxXQUFXLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxxQkFBcUIsS0FBSyxDQUFDLE9BQU8sRUFBRSxFQUFFLENBQUM7UUFDL0YsQ0FBQztJQUNILENBQUM7SUFFRDs7T0FFRztJQUNJLEtBQUssQ0FBQyxrQkFBa0IsQ0FBQyxNQUFjLEVBQUUsTUFBd0IsRUFBRSxXQUFrQztRQUsxRyw4QkFBOEI7UUFDOUIsTUFBTSxXQUFXLEdBQUcsTUFBTSxJQUFJLENBQUMseUJBQXlCLENBQUMsTUFBTSxFQUFFLE1BQU0sRUFBRSxXQUFXLENBQUMsQ0FBQztRQUV0RixJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sRUFBRSxDQUFDO1lBQ3pCLE9BQU8sRUFBRSxXQUFXLEVBQUUsQ0FBQztRQUN6QixDQUFDO1FBRUQsSUFBSSxDQUFDO1lBQ0gsaURBQWlEO1lBQ2pELE1BQU0sTUFBTSxHQUFHLDJCQUFpQixDQUFDLG1CQUFtQixDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBRTdELDZCQUE2QjtZQUM3QixNQUFNLGVBQWUsR0FBb0I7Z0JBQ3ZDLFFBQVEsRUFBRSxNQUFNLENBQUMsUUFBUTtnQkFDekIsWUFBWSxFQUFFLE1BQU0sQ0FBQyxZQUFZO2dCQUNqQyxRQUFRLEVBQUUsTUFBTSxDQUFDLFFBQVE7Z0JBQ3pCLE9BQU8sRUFBRSxNQUFNLENBQUMsT0FBTztnQkFDdkIsUUFBUSxFQUFFLE1BQU0sQ0FBQyxRQUFRO2dCQUN6QixLQUFLLEVBQUUsTUFBTSxDQUFDLEtBQUs7Z0JBQ25CLE1BQU0sRUFBRSxNQUFNLENBQUMsTUFBTTtnQkFDckIsV0FBVyxFQUFFLE1BQU0sQ0FBQyxXQUFXO2dCQUMvQixJQUFJLEVBQUUsTUFBTSxDQUFDLElBQUk7Z0JBQ2pCLFFBQVEsRUFBRSxNQUFNLENBQUMsUUFBUTthQUMxQixDQUFDO1lBRUYsTUFBTSxVQUFVLEdBQUcseUJBQWUsQ0FBQyx3QkFBd0IsQ0FBQyxlQUFlLENBQUMsQ0FBQztZQUU3RSxPQUFPO2dCQUNMLE1BQU07Z0JBQ04sVUFBVTtnQkFDVixXQUFXO2FBQ1osQ0FBQztRQUVKLENBQUM7UUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1lBQ2YsT0FBTztnQkFDTCxXQUFXLEVBQUU7b0JBQ1gsT0FBTyxFQUFFLEtBQUs7b0JBQ2QsTUFBTSxFQUFFLHNCQUFzQixLQUFLLENBQUMsT0FBTyxFQUFFO29CQUM3QyxXQUFXLEVBQUUsV0FBVyxDQUFDLFdBQVc7aUJBQ3JDO2FBQ0YsQ0FBQztRQUNKLENBQUM7SUFDSCxDQUFDO0lBRUQ7O09BRUc7SUFDSywyQkFBMkIsQ0FBQyxNQUF3QixFQUFFLFdBQWtDO1FBQzlGLElBQUksS0FBSyxHQUFHLENBQUMsQ0FBQztRQUNkLE1BQU0sT0FBTyxHQUFHO1lBQ2QsWUFBWSxFQUFFLFdBQVcsRUFBRSxRQUFRLEVBQUUsTUFBTSxJQUFJLENBQUM7WUFDaEQsU0FBUyxFQUFFLFdBQVcsRUFBRSxLQUFLLEVBQUUsTUFBTSxJQUFJLENBQUM7WUFDMUMsY0FBYyxFQUFFLFdBQVcsRUFBRSxTQUFTLEVBQUUsTUFBTSxJQUFJLENBQUM7WUFDbkQsZUFBZSxFQUFFLE1BQU0sQ0FBQyxRQUFRLElBQUksTUFBTSxDQUFDLFFBQVEsS0FBSyxrQkFBa0IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2xGLGdCQUFnQixFQUFFLENBQUM7U0FDcEIsQ0FBQztRQUVGLDhCQUE4QjtRQUM5QixLQUFLLElBQUksSUFBSSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsWUFBWSxHQUFHLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUNoRCxLQUFLLElBQUksSUFBSSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsU0FBUyxHQUFHLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUM3QyxLQUFLLElBQUksSUFBSSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsY0FBYyxHQUFHLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUVsRCx3Q0FBd0M7UUFDeEMsSUFBSSxNQUFNLENBQUMsWUFBWSxHQUFHLElBQUk7WUFBRSxLQUFLLElBQUksRUFBRSxDQUFDLENBQUMscUJBQXFCO1FBQ2xFLElBQUksTUFBTSxDQUFDLGNBQWMsSUFBSSxNQUFNLENBQUMsY0FBYyxHQUFHLElBQUk7WUFBRSxLQUFLLElBQUksRUFBRSxDQUFDLENBQUMsZ0JBQWdCO1FBQ3hGLElBQUksTUFBTSxDQUFDLFFBQVEsS0FBSyxhQUFhO1lBQUUsS0FBSyxJQUFJLENBQUMsQ0FBQyxDQUFDLDBCQUEwQjtRQUU3RSxrQ0FBa0M7UUFDbEMsS0FBSyxJQUFJLE9BQU8sQ0FBQyxlQUFlLEdBQUcsRUFBRSxDQUFDO1FBRXRDLCtDQUErQztRQUMvQyxJQUFJLEtBQXFDLENBQUM7UUFDMUMsSUFBSSxZQUFzQixDQUFDO1FBRTNCLElBQUksS0FBSyxJQUFJLEVBQUUsRUFBRSxDQUFDO1lBQ2hCLEtBQUssR0FBRyxPQUFPLENBQUM7WUFDaEIsWUFBWSxHQUFHLE1BQU0sQ0FBQztRQUN4QixDQUFDO2FBQU0sSUFBSSxLQUFLLElBQUksRUFBRSxFQUFFLENBQUM7WUFDdkIsS0FBSyxHQUFHLGNBQWMsQ0FBQztZQUN2QixZQUFZLEdBQUcsS0FBSyxDQUFDO1FBQ3ZCLENBQUM7YUFBTSxJQUFJLEtBQUssSUFBSSxFQUFFLEVBQUUsQ0FBQztZQUN2QixLQUFLLEdBQUcsVUFBVSxDQUFDO1lBQ25CLFlBQVksR0FBRyxLQUFLLENBQUM7UUFDdkIsQ0FBQzthQUFNLENBQUM7WUFDTixLQUFLLEdBQUcsUUFBUSxDQUFDO1lBQ2pCLFlBQVksR0FBRyxZQUFZLENBQUM7UUFDOUIsQ0FBQztRQUVELE9BQU87WUFDTCxLQUFLO1lBQ0wsS0FBSyxFQUFFLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxFQUFFLEdBQUcsQ0FBQztZQUMzQixPQUFPO1lBQ1AsWUFBWTtTQUNiLENBQUM7SUFDSixDQUFDO0lBRUQ7O09BRUc7SUFDSyxLQUFLLENBQUMsV0FBVyxDQUFDLE1BQWM7UUFDdEMsSUFBSSxDQUFDO1lBQ0gsaURBQWlEO1lBQ2pELE1BQU0sUUFBUSxHQUFHLElBQUksQ0FBQyxjQUFjLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztZQUN2RCxNQUFNLElBQUksR0FBRyxNQUFNLFFBQVEsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDNUMsT0FBTyxJQUFJLEVBQUUsSUFBSSxJQUFJLE1BQU0sQ0FBQztRQUM5QixDQUFDO1FBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztZQUNmLE9BQU8sQ0FBQyxLQUFLLENBQUMsMEJBQTBCLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFDakQsT0FBTyxNQUFNLENBQUMsQ0FBQyxnQ0FBZ0M7UUFDakQsQ0FBQztJQUNILENBQUM7SUFFRDs7O09BR0c7SUFDSyxLQUFLLENBQUMsbUJBQW1CLENBQUMsTUFBYztRQUM5QyxxRUFBcUU7UUFDckUsMkVBQTJFO1FBQzNFLE9BQU8sT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUM1QixDQUFDO0lBRUQ7O09BRUc7SUFDSSxNQUFNLENBQUMsYUFBYSxDQUFDLElBQWM7UUFDeEMsT0FBTyxFQUFFLEdBQUcsWUFBWSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDO0lBQy9DLENBQUM7SUFFRDs7T0FFRztJQUNJLE1BQU0sQ0FBQyxnQkFBZ0I7UUFDNUIsT0FBTyxFQUFFLEdBQUcsWUFBWSxDQUFDLGNBQWMsRUFBRSxDQUFDO0lBQzVDLENBQUM7SUFFRDs7T0FFRztJQUNJLE1BQU0sQ0FBQyx5QkFBeUIsQ0FBQyxJQUFjO1FBQ3BELE1BQU0sTUFBTSxHQUFHLFlBQVksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDOUMsT0FBTyxNQUFNLENBQUMsb0JBQW9CLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsWUFBWSxDQUFDLGNBQWMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNoRyxDQUFDOztBQXRpQkgsb0NBdWlCQztBQW5pQkMsNEJBQTRCO0FBQ0osd0JBQVcsR0FBaUM7SUFDbEUsSUFBSSxFQUFFO1FBQ0osV0FBVyxFQUFFLENBQUM7UUFDZCxxQkFBcUIsRUFBRSxFQUFFO1FBQ3pCLGtCQUFrQixFQUFFLENBQUM7UUFDckIsc0JBQXNCLEVBQUUsQ0FBQztRQUN6Qix3QkFBd0IsRUFBRSxPQUFPO1FBQ2pDLG9CQUFvQixFQUFFLENBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQztRQUNyQyxtQkFBbUIsRUFBRSxJQUFJO1FBQ3pCLGtCQUFrQixFQUFFLElBQUk7UUFDeEIsZ0JBQWdCLEVBQUUsRUFBRTtLQUNyQjtJQUNELEdBQUcsRUFBRTtRQUNILFdBQVcsRUFBRSxDQUFDLENBQUMsRUFBRSxZQUFZO1FBQzdCLHFCQUFxQixFQUFFLEdBQUc7UUFDMUIsa0JBQWtCLEVBQUUsRUFBRTtRQUN0QixzQkFBc0IsRUFBRSxFQUFFO1FBQzFCLHdCQUF3QixFQUFFLFVBQVU7UUFDcEMsb0JBQW9CLEVBQUUsQ0FBQyxLQUFLLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxPQUFPLENBQUM7UUFDckQsbUJBQW1CLEVBQUUsSUFBSSxFQUFFLEtBQUs7UUFDaEMsa0JBQWtCLEVBQUUsS0FBSztRQUN6QixnQkFBZ0IsRUFBRSxDQUFDLG9CQUFvQixFQUFFLHFCQUFxQixFQUFFLHFCQUFxQixFQUFFLHFCQUFxQixDQUFDO0tBQzlHO0lBQ0QsVUFBVSxFQUFFO1FBQ1YsV0FBVyxFQUFFLENBQUMsQ0FBQyxFQUFFLFlBQVk7UUFDN0IscUJBQXFCLEVBQUUsQ0FBQyxDQUFDLEVBQUUsWUFBWTtRQUN2QyxrQkFBa0IsRUFBRSxDQUFDLENBQUMsRUFBRSxZQUFZO1FBQ3BDLHNCQUFzQixFQUFFLENBQUMsQ0FBQyxFQUFFLFlBQVk7UUFDeEMsd0JBQXdCLEVBQUUsUUFBUTtRQUNsQyxvQkFBb0IsRUFBRSxDQUFDLEtBQUssRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUUsS0FBSyxDQUFDO1FBQ25FLG1CQUFtQixFQUFFLElBQUksRUFBRSxLQUFLO1FBQ2hDLGtCQUFrQixFQUFFLEtBQUs7UUFDekIsZ0JBQWdCLEVBQUUsQ0FBQyxvQkFBb0IsRUFBRSxxQkFBcUIsRUFBRSxxQkFBcUIsRUFBRSxxQkFBcUIsRUFBRSxZQUFZLEVBQUUsWUFBWSxFQUFFLGlCQUFpQixDQUFDO0tBQzdKO0NBQ0YsQ0FBQztBQUVGLDRCQUE0QjtBQUNKLDJCQUFjLEdBQWlDO0lBQ3JFLEdBQUcsRUFBRTtRQUNILEVBQUUsRUFBRSxLQUFLO1FBQ1QsSUFBSSxFQUFFLFlBQVk7UUFDbEIsV0FBVyxFQUFFLGdEQUFnRDtRQUM3RCxZQUFZLEVBQUUsTUFBTTtRQUNwQixXQUFXLEVBQUUsZ0JBQWdCO0tBQzlCO0lBQ0QsSUFBSSxFQUFFO1FBQ0osRUFBRSxFQUFFLE1BQU07UUFDVixJQUFJLEVBQUUsV0FBVztRQUNqQixXQUFXLEVBQUUsb0NBQW9DO1FBQ2pELFlBQVksRUFBRSxNQUFNO1FBQ3BCLFdBQVcsRUFBRSxnQkFBZ0I7S0FDOUI7SUFDRCxHQUFHLEVBQUU7UUFDSCxFQUFFLEVBQUUsS0FBSztRQUNULElBQUksRUFBRSxXQUFXO1FBQ2pCLFdBQVcsRUFBRSxnQ0FBZ0M7UUFDN0MsWUFBWSxFQUFFLEtBQUs7UUFDbkIsV0FBVyxFQUFFLHFCQUFxQjtRQUNsQyxhQUFhLEVBQUUsSUFBSTtLQUNwQjtJQUNELEtBQUssRUFBRTtRQUNMLEVBQUUsRUFBRSxPQUFPO1FBQ1gsSUFBSSxFQUFFLG1CQUFtQjtRQUN6QixXQUFXLEVBQUUseUNBQXlDO1FBQ3RELFlBQVksRUFBRSxLQUFLO1FBQ25CLFdBQVcsRUFBRSxxQkFBcUI7S0FDbkM7SUFDRCxHQUFHLEVBQUU7UUFDSCxFQUFFLEVBQUUsS0FBSztRQUNULElBQUksRUFBRSxpQkFBaUI7UUFDdkIsV0FBVyxFQUFFLDZCQUE2QjtRQUMxQyxZQUFZLEVBQUUsWUFBWTtRQUMxQixXQUFXLEVBQUUsWUFBWTtLQUMxQjtJQUNELEdBQUcsRUFBRTtRQUNILEVBQUUsRUFBRSxLQUFLO1FBQ1QsSUFBSSxFQUFFLFdBQVc7UUFDakIsV0FBVyxFQUFFLG1DQUFtQztRQUNoRCxZQUFZLEVBQUUsWUFBWTtRQUMxQixXQUFXLEVBQUUsWUFBWTtLQUMxQjtDQUNGLENBQUM7QUFtZEosa0JBQWUsWUFBWSxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9qb2hucmV5cmF6b25hYmxlL0RvY3VtZW50cy9TaXplV2lzZV9TdWl0ZV9BcHAvYmFja2VuZC9zZXJ2aWNlcy9lbmZvcmNlbWVudC9UaWVyRW5mb3JjZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBUaWVyRW5mb3JjZXIgLSBCdXNpbmVzcyBMb2dpYyBUaWVyIEVuZm9yY2VtZW50IEVuZ2luZVxuICpcbiAqIE1JU1NJT04tQ1JJVElDQUw6IFNlcnZpY2UgbGF5ZXIgZm9yIHRpZXItYmFzZWQgYnVzaW5lc3MgbG9naWMgZW5mb3JjZW1lbnRcbiAqIENvbXBsZW1lbnRzIFVJIHRpZXIgZW5mb3JjZW1lbnQgd2l0aCBzZXJ2ZXItc2lkZSB2YWxpZGF0aW9uIGFuZCBsaW1pdHNcbiAqXG4gKiBAc2VlIGRvY3MvaW1wbGVtZW50YXRpb24vdGllci1zeXN0ZW0vdGllci1ib3VuZGFyaWVzLXNwZWNpZmljYXRpb24ubWRcbiAqIEBzZWUgZG9jcy9kZXZlbG9wZXItZ3VpZGUvdGllci1pbXBsZW1lbnRhdGlvbi1jaGVja2xpc3QubWQgc2VjdGlvbiAyLjVcbiAqL1xuXG5pbXBvcnQgeyBGZWF0dXJlTWFuYWdlciB9IGZyb20gJy4uLy4uL2ZlYXR1cmVzL0ZlYXR1cmVNYW5hZ2VyJztcbmltcG9ydCB7IERhdGFiYXNlTWFuYWdlciB9IGZyb20gJy4uLy4uL2RhdGFiYXNlL0RhdGFiYXNlTWFuYWdlcic7XG5pbXBvcnQgQWlyRHVjdENhbGN1bGF0b3IsIHsgRHVjdFNpemluZ0lucHV0cywgRHVjdFNpemluZ1Jlc3VsdHMgfSBmcm9tICcuLi9jYWxjdWxhdGlvbnMvQWlyRHVjdENhbGN1bGF0b3InO1xuaW1wb3J0IFNNQUNOQVZhbGlkYXRvciwgeyBDYWxjdWxhdGlvbkRhdGEsIFZhbGlkYXRpb25SZXN1bHQgfSBmcm9tICcuLi9jYWxjdWxhdGlvbnMvU01BQ05BVmFsaWRhdG9yJztcblxuLyoqXG4gKiBVc2VyIHRpZXIgdHlwZVxuICovXG5leHBvcnQgdHlwZSBVc2VyVGllciA9ICdmcmVlJyB8ICdwcm8nIHwgJ2VudGVycHJpc2UnO1xuXG4vKipcbiAqIFByb2plY3QgZGF0YSBzdHJ1Y3R1cmVcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBQcm9qZWN0RGF0YSB7XG4gIGlkOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbiAgdXNlcklkOiBzdHJpbmc7XG4gIHNlZ21lbnRzOiBhbnlbXTtcbiAgcm9vbXM6IGFueVtdO1xuICBlcXVpcG1lbnQ6IGFueVtdO1xuICBjcmVhdGVkQXQ6IERhdGU7XG4gIHVwZGF0ZWRBdDogRGF0ZTtcbn1cblxuLyoqXG4gKiBFeHBvcnQgZm9ybWF0IGNvbmZpZ3VyYXRpb25cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBFeHBvcnRGb3JtYXQge1xuICBpZDogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gIHJlcXVpcmVkVGllcjogVXNlclRpZXI7XG4gIGZlYXR1cmVOYW1lOiBzdHJpbmc7XG4gIG1heFJlc29sdXRpb24/OiBudW1iZXI7XG4gIG1heEZpbGVTaXplPzogbnVtYmVyOyAvLyBNQlxuICB3YXRlcm1hcmtlZD86IGJvb2xlYW47XG59XG5cbi8qKlxuICogQ2FsY3VsYXRpb24gY29tcGxleGl0eSBhc3Nlc3NtZW50XG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQ2FsY3VsYXRpb25Db21wbGV4aXR5IHtcbiAgbGV2ZWw6ICdiYXNpYycgfCAnaW50ZXJtZWRpYXRlJyB8ICdhZHZhbmNlZCcgfCAnZXhwZXJ0JztcbiAgc2NvcmU6IG51bWJlcjsgLy8gMC0xMDBcbiAgZmFjdG9yczoge1xuICAgIHNlZ21lbnRDb3VudDogbnVtYmVyO1xuICAgIHJvb21Db3VudDogbnVtYmVyO1xuICAgIGVxdWlwbWVudENvdW50OiBudW1iZXI7XG4gICAgY3VzdG9tTWF0ZXJpYWxzOiBudW1iZXI7XG4gICAgYWR2YW5jZWRGZWF0dXJlczogbnVtYmVyO1xuICB9O1xuICByZXF1aXJlZFRpZXI6IFVzZXJUaWVyO1xufVxuXG4vKipcbiAqIEVuZm9yY2VtZW50IHJlc3VsdFxuICovXG5leHBvcnQgaW50ZXJmYWNlIEVuZm9yY2VtZW50UmVzdWx0IHtcbiAgYWxsb3dlZDogYm9vbGVhbjtcbiAgcmVhc29uPzogc3RyaW5nO1xuICBjdXJyZW50VGllcjogVXNlclRpZXI7XG4gIHJlcXVpcmVkVGllcj86IFVzZXJUaWVyO1xuICB1cGdyYWRlTWVzc2FnZT86IHN0cmluZztcbiAgbGltaXRhdGlvbnM/OiBzdHJpbmdbXTtcbiAgcmVjb21tZW5kYXRpb25zPzogc3RyaW5nW107XG59XG5cbi8qKlxuICogUHJvamVjdCBsaW1pdHMgYnkgdGllclxuICovXG5pbnRlcmZhY2UgVGllckxpbWl0cyB7XG4gIG1heFByb2plY3RzOiBudW1iZXI7XG4gIG1heFNlZ21lbnRzUGVyUHJvamVjdDogbnVtYmVyO1xuICBtYXhSb29tc1BlclByb2plY3Q6IG51bWJlcjtcbiAgbWF4RXF1aXBtZW50UGVyUHJvamVjdDogbnVtYmVyO1xuICBtYXhDYWxjdWxhdGlvbkNvbXBsZXhpdHk6ICdiYXNpYycgfCAnaW50ZXJtZWRpYXRlJyB8ICdhZHZhbmNlZCcgfCAnZXhwZXJ0JztcbiAgYWxsb3dlZEV4cG9ydEZvcm1hdHM6IHN0cmluZ1tdO1xuICBtYXhFeHBvcnRSZXNvbHV0aW9uOiBudW1iZXI7XG4gIHdhdGVybWFya2VkRXhwb3J0czogYm9vbGVhbjtcbiAgYWR2YW5jZWRGZWF0dXJlczogc3RyaW5nW107XG59XG5cbi8qKlxuICogVGllckVuZm9yY2VyIC0gQnVzaW5lc3MgbG9naWMgZW5mb3JjZW1lbnQgZm9yIHRpZXIgYm91bmRhcmllc1xuICogQ1JJVElDQUw6IFByb3ZpZGVzIHNlcnZlci1zaWRlIHZhbGlkYXRpb24gdG8gcHJldmVudCB0aWVyIGNpcmN1bXZlbnRpb25cbiAqL1xuZXhwb3J0IGNsYXNzIFRpZXJFbmZvcmNlciB7XG4gIHByaXZhdGUgZmVhdHVyZU1hbmFnZXI6IEZlYXR1cmVNYW5hZ2VyO1xuICBwcml2YXRlIGRiTWFuYWdlcjogRGF0YWJhc2VNYW5hZ2VyO1xuXG4gIC8vIFRpZXIgbGltaXRzIGNvbmZpZ3VyYXRpb25cbiAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgVElFUl9MSU1JVFM6IFJlY29yZDxVc2VyVGllciwgVGllckxpbWl0cz4gPSB7XG4gICAgZnJlZToge1xuICAgICAgbWF4UHJvamVjdHM6IDMsXG4gICAgICBtYXhTZWdtZW50c1BlclByb2plY3Q6IDEwLFxuICAgICAgbWF4Um9vbXNQZXJQcm9qZWN0OiA1LFxuICAgICAgbWF4RXF1aXBtZW50UGVyUHJvamVjdDogMyxcbiAgICAgIG1heENhbGN1bGF0aW9uQ29tcGxleGl0eTogJ2Jhc2ljJyxcbiAgICAgIGFsbG93ZWRFeHBvcnRGb3JtYXRzOiBbJ3BkZicsICdqc29uJ10sXG4gICAgICBtYXhFeHBvcnRSZXNvbHV0aW9uOiAxMDgwLFxuICAgICAgd2F0ZXJtYXJrZWRFeHBvcnRzOiB0cnVlLFxuICAgICAgYWR2YW5jZWRGZWF0dXJlczogW11cbiAgICB9LFxuICAgIHBybzoge1xuICAgICAgbWF4UHJvamVjdHM6IC0xLCAvLyBVbmxpbWl0ZWRcbiAgICAgIG1heFNlZ21lbnRzUGVyUHJvamVjdDogMTAwLFxuICAgICAgbWF4Um9vbXNQZXJQcm9qZWN0OiA1MCxcbiAgICAgIG1heEVxdWlwbWVudFBlclByb2plY3Q6IDI1LFxuICAgICAgbWF4Q2FsY3VsYXRpb25Db21wbGV4aXR5OiAnYWR2YW5jZWQnLFxuICAgICAgYWxsb3dlZEV4cG9ydEZvcm1hdHM6IFsncGRmJywgJ2pzb24nLCAncG5nJywgJ2V4Y2VsJ10sXG4gICAgICBtYXhFeHBvcnRSZXNvbHV0aW9uOiA0MzIwLCAvLyA0S1xuICAgICAgd2F0ZXJtYXJrZWRFeHBvcnRzOiBmYWxzZSxcbiAgICAgIGFkdmFuY2VkRmVhdHVyZXM6IFsndW5saW1pdGVkX3NlZ21lbnRzJywgJ2VxdWlwbWVudF9zZWxlY3Rpb24nLCAnaGlnaF9yZXNfcGRmX2V4cG9ydCcsICdlbmhhbmNlZF9jc3ZfZXhwb3J0J11cbiAgICB9LFxuICAgIGVudGVycHJpc2U6IHtcbiAgICAgIG1heFByb2plY3RzOiAtMSwgLy8gVW5saW1pdGVkXG4gICAgICBtYXhTZWdtZW50c1BlclByb2plY3Q6IC0xLCAvLyBVbmxpbWl0ZWRcbiAgICAgIG1heFJvb21zUGVyUHJvamVjdDogLTEsIC8vIFVubGltaXRlZFxuICAgICAgbWF4RXF1aXBtZW50UGVyUHJvamVjdDogLTEsIC8vIFVubGltaXRlZFxuICAgICAgbWF4Q2FsY3VsYXRpb25Db21wbGV4aXR5OiAnZXhwZXJ0JyxcbiAgICAgIGFsbG93ZWRFeHBvcnRGb3JtYXRzOiBbJ3BkZicsICdqc29uJywgJ3BuZycsICdleGNlbCcsICdkd2cnLCAnaWZjJ10sXG4gICAgICBtYXhFeHBvcnRSZXNvbHV0aW9uOiA4NjQwLCAvLyA4S1xuICAgICAgd2F0ZXJtYXJrZWRFeHBvcnRzOiBmYWxzZSxcbiAgICAgIGFkdmFuY2VkRmVhdHVyZXM6IFsndW5saW1pdGVkX3NlZ21lbnRzJywgJ2VxdWlwbWVudF9zZWxlY3Rpb24nLCAnaGlnaF9yZXNfcGRmX2V4cG9ydCcsICdlbmhhbmNlZF9jc3ZfZXhwb3J0JywgJ2NhZF9leHBvcnQnLCAnYXBpX2FjY2VzcycsICdidWxrX29wZXJhdGlvbnMnXVxuICAgIH1cbiAgfTtcblxuICAvLyBFeHBvcnQgZm9ybWF0IGRlZmluaXRpb25zXG4gIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IEVYUE9SVF9GT1JNQVRTOiBSZWNvcmQ8c3RyaW5nLCBFeHBvcnRGb3JtYXQ+ID0ge1xuICAgIHBkZjoge1xuICAgICAgaWQ6ICdwZGYnLFxuICAgICAgbmFtZTogJ1BERiBSZXBvcnQnLFxuICAgICAgZGVzY3JpcHRpb246ICdDb21wbGV0ZSBwcm9qZWN0IHJlcG9ydCB3aXRoIEJPTSBhbmQgc2NoZWR1bGVzJyxcbiAgICAgIHJlcXVpcmVkVGllcjogJ2ZyZWUnLFxuICAgICAgZmVhdHVyZU5hbWU6ICdhaXJfZHVjdF9zaXplcidcbiAgICB9LFxuICAgIGpzb246IHtcbiAgICAgIGlkOiAnanNvbicsXG4gICAgICBuYW1lOiAnSlNPTiBEYXRhJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnUHJvamVjdCBkYXRhIGZvciBiYWNrdXAgb3Igc2hhcmluZycsXG4gICAgICByZXF1aXJlZFRpZXI6ICdmcmVlJyxcbiAgICAgIGZlYXR1cmVOYW1lOiAnYWlyX2R1Y3Rfc2l6ZXInXG4gICAgfSxcbiAgICBwbmc6IHtcbiAgICAgIGlkOiAncG5nJyxcbiAgICAgIG5hbWU6ICdQTkcgSW1hZ2UnLFxuICAgICAgZGVzY3JpcHRpb246ICdIaWdoLXJlc29sdXRpb24gZHJhd2luZyBleHBvcnQnLFxuICAgICAgcmVxdWlyZWRUaWVyOiAncHJvJyxcbiAgICAgIGZlYXR1cmVOYW1lOiAnaGlnaF9yZXNfcGRmX2V4cG9ydCcsXG4gICAgICBtYXhSZXNvbHV0aW9uOiA0MzIwXG4gICAgfSxcbiAgICBleGNlbDoge1xuICAgICAgaWQ6ICdleGNlbCcsXG4gICAgICBuYW1lOiAnRXhjZWwgU3ByZWFkc2hlZXQnLFxuICAgICAgZGVzY3JpcHRpb246ICdCT00gYW5kIHNjaGVkdWxlcyBpbiBzcHJlYWRzaGVldCBmb3JtYXQnLFxuICAgICAgcmVxdWlyZWRUaWVyOiAncHJvJyxcbiAgICAgIGZlYXR1cmVOYW1lOiAnZW5oYW5jZWRfY3N2X2V4cG9ydCdcbiAgICB9LFxuICAgIGR3Zzoge1xuICAgICAgaWQ6ICdkd2cnLFxuICAgICAgbmFtZTogJ0F1dG9DQUQgRHJhd2luZycsXG4gICAgICBkZXNjcmlwdGlvbjogJ0NBRC1jb21wYXRpYmxlIGRyYXdpbmcgZmlsZScsXG4gICAgICByZXF1aXJlZFRpZXI6ICdlbnRlcnByaXNlJyxcbiAgICAgIGZlYXR1cmVOYW1lOiAnY2FkX2V4cG9ydCdcbiAgICB9LFxuICAgIGlmYzoge1xuICAgICAgaWQ6ICdpZmMnLFxuICAgICAgbmFtZTogJ0lGQyBNb2RlbCcsXG4gICAgICBkZXNjcmlwdGlvbjogJ0J1aWxkaW5nIEluZm9ybWF0aW9uIE1vZGVsIGZvcm1hdCcsXG4gICAgICByZXF1aXJlZFRpZXI6ICdlbnRlcnByaXNlJyxcbiAgICAgIGZlYXR1cmVOYW1lOiAnY2FkX2V4cG9ydCdcbiAgICB9XG4gIH07XG5cbiAgY29uc3RydWN0b3IoZmVhdHVyZU1hbmFnZXI6IEZlYXR1cmVNYW5hZ2VyLCBkYk1hbmFnZXI6IERhdGFiYXNlTWFuYWdlcikge1xuICAgIHRoaXMuZmVhdHVyZU1hbmFnZXIgPSBmZWF0dXJlTWFuYWdlcjtcbiAgICB0aGlzLmRiTWFuYWdlciA9IGRiTWFuYWdlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBWYWxpZGF0ZSBwcm9qZWN0IGNyZWF0aW9uIGxpbWl0c1xuICAgKi9cbiAgcHVibGljIGFzeW5jIHZhbGlkYXRlUHJvamVjdENyZWF0aW9uKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxFbmZvcmNlbWVudFJlc3VsdD4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBHZXQgdXNlciB0aWVyXG4gICAgICBjb25zdCB1c2VyVGllciA9IGF3YWl0IHRoaXMuZ2V0VXNlclRpZXIodXNlcklkKTtcbiAgICAgIGNvbnN0IGxpbWl0cyA9IFRpZXJFbmZvcmNlci5USUVSX0xJTUlUU1t1c2VyVGllcl07XG5cbiAgICAgIC8vIENoZWNrIGlmIHVubGltaXRlZCBwcm9qZWN0cyBhbGxvd2VkXG4gICAgICBpZiAobGltaXRzLm1heFByb2plY3RzID09PSAtMSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGFsbG93ZWQ6IHRydWUsXG4gICAgICAgICAgY3VycmVudFRpZXI6IHVzZXJUaWVyXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIC8vIENvdW50IGV4aXN0aW5nIHByb2plY3RzXG4gICAgICBjb25zdCBwcm9qZWN0Q291bnQgPSBhd2FpdCB0aGlzLmdldFVzZXJQcm9qZWN0Q291bnQodXNlcklkKTtcblxuICAgICAgaWYgKHByb2plY3RDb3VudCA+PSBsaW1pdHMubWF4UHJvamVjdHMpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBhbGxvd2VkOiBmYWxzZSxcbiAgICAgICAgICByZWFzb246IGBQcm9qZWN0IGxpbWl0IHJlYWNoZWQgKCR7cHJvamVjdENvdW50fS8ke2xpbWl0cy5tYXhQcm9qZWN0c30pYCxcbiAgICAgICAgICBjdXJyZW50VGllcjogdXNlclRpZXIsXG4gICAgICAgICAgcmVxdWlyZWRUaWVyOiAncHJvJyxcbiAgICAgICAgICB1cGdyYWRlTWVzc2FnZTogYFVwZ3JhZGUgdG8gUHJvIGZvciB1bmxpbWl0ZWQgcHJvamVjdHNgLFxuICAgICAgICAgIGxpbWl0YXRpb25zOiBbYEZyZWUgdGllciBsaW1pdGVkIHRvICR7bGltaXRzLm1heFByb2plY3RzfSBwcm9qZWN0c2BdXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGFsbG93ZWQ6IHRydWUsXG4gICAgICAgIGN1cnJlbnRUaWVyOiB1c2VyVGllcixcbiAgICAgICAgbGltaXRhdGlvbnM6IFtgJHtwcm9qZWN0Q291bnQgKyAxfS8ke2xpbWl0cy5tYXhQcm9qZWN0c30gcHJvamVjdHMgdXNlZGBdXG4gICAgICB9O1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGFsbG93ZWQ6IGZhbHNlLFxuICAgICAgICByZWFzb246IGBWYWxpZGF0aW9uIGVycm9yOiAke2Vycm9yLm1lc3NhZ2V9YCxcbiAgICAgICAgY3VycmVudFRpZXI6ICdmcmVlJ1xuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGUgcHJvamVjdCBjb250ZW50IGxpbWl0cyAoc2VnbWVudHMsIHJvb21zLCBlcXVpcG1lbnQpXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgdmFsaWRhdGVQcm9qZWN0Q29udGVudCh1c2VySWQ6IHN0cmluZywgcHJvamVjdERhdGE6IFBhcnRpYWw8UHJvamVjdERhdGE+KTogUHJvbWlzZTxFbmZvcmNlbWVudFJlc3VsdD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB1c2VyVGllciA9IGF3YWl0IHRoaXMuZ2V0VXNlclRpZXIodXNlcklkKTtcbiAgICAgIGNvbnN0IGxpbWl0cyA9IFRpZXJFbmZvcmNlci5USUVSX0xJTUlUU1t1c2VyVGllcl07XG5cbiAgICAgIGNvbnN0IHZpb2xhdGlvbnM6IHN0cmluZ1tdID0gW107XG4gICAgICBjb25zdCBsaW1pdGF0aW9uczogc3RyaW5nW10gPSBbXTtcblxuICAgICAgLy8gQ2hlY2sgc2VnbWVudCBjb3VudFxuICAgICAgY29uc3Qgc2VnbWVudENvdW50ID0gcHJvamVjdERhdGEuc2VnbWVudHM/Lmxlbmd0aCB8fCAwO1xuICAgICAgaWYgKGxpbWl0cy5tYXhTZWdtZW50c1BlclByb2plY3QgIT09IC0xICYmIHNlZ21lbnRDb3VudCA+IGxpbWl0cy5tYXhTZWdtZW50c1BlclByb2plY3QpIHtcbiAgICAgICAgdmlvbGF0aW9ucy5wdXNoKGBUb28gbWFueSBzZWdtZW50cyAoJHtzZWdtZW50Q291bnR9LyR7bGltaXRzLm1heFNlZ21lbnRzUGVyUHJvamVjdH0pYCk7XG4gICAgICB9IGVsc2UgaWYgKGxpbWl0cy5tYXhTZWdtZW50c1BlclByb2plY3QgIT09IC0xKSB7XG4gICAgICAgIGxpbWl0YXRpb25zLnB1c2goYCR7c2VnbWVudENvdW50fS8ke2xpbWl0cy5tYXhTZWdtZW50c1BlclByb2plY3R9IHNlZ21lbnRzIHVzZWRgKTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgcm9vbSBjb3VudFxuICAgICAgY29uc3Qgcm9vbUNvdW50ID0gcHJvamVjdERhdGEucm9vbXM/Lmxlbmd0aCB8fCAwO1xuICAgICAgaWYgKGxpbWl0cy5tYXhSb29tc1BlclByb2plY3QgIT09IC0xICYmIHJvb21Db3VudCA+IGxpbWl0cy5tYXhSb29tc1BlclByb2plY3QpIHtcbiAgICAgICAgdmlvbGF0aW9ucy5wdXNoKGBUb28gbWFueSByb29tcyAoJHtyb29tQ291bnR9LyR7bGltaXRzLm1heFJvb21zUGVyUHJvamVjdH0pYCk7XG4gICAgICB9IGVsc2UgaWYgKGxpbWl0cy5tYXhSb29tc1BlclByb2plY3QgIT09IC0xKSB7XG4gICAgICAgIGxpbWl0YXRpb25zLnB1c2goYCR7cm9vbUNvdW50fS8ke2xpbWl0cy5tYXhSb29tc1BlclByb2plY3R9IHJvb21zIHVzZWRgKTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgZXF1aXBtZW50IGNvdW50XG4gICAgICBjb25zdCBlcXVpcG1lbnRDb3VudCA9IHByb2plY3REYXRhLmVxdWlwbWVudD8ubGVuZ3RoIHx8IDA7XG4gICAgICBpZiAobGltaXRzLm1heEVxdWlwbWVudFBlclByb2plY3QgIT09IC0xICYmIGVxdWlwbWVudENvdW50ID4gbGltaXRzLm1heEVxdWlwbWVudFBlclByb2plY3QpIHtcbiAgICAgICAgdmlvbGF0aW9ucy5wdXNoKGBUb28gbWFueSBlcXVpcG1lbnQgaXRlbXMgKCR7ZXF1aXBtZW50Q291bnR9LyR7bGltaXRzLm1heEVxdWlwbWVudFBlclByb2plY3R9KWApO1xuICAgICAgfSBlbHNlIGlmIChsaW1pdHMubWF4RXF1aXBtZW50UGVyUHJvamVjdCAhPT0gLTEpIHtcbiAgICAgICAgbGltaXRhdGlvbnMucHVzaChgJHtlcXVpcG1lbnRDb3VudH0vJHtsaW1pdHMubWF4RXF1aXBtZW50UGVyUHJvamVjdH0gZXF1aXBtZW50IGl0ZW1zIHVzZWRgKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHZpb2xhdGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGFsbG93ZWQ6IGZhbHNlLFxuICAgICAgICAgIHJlYXNvbjogdmlvbGF0aW9ucy5qb2luKCcsICcpLFxuICAgICAgICAgIGN1cnJlbnRUaWVyOiB1c2VyVGllcixcbiAgICAgICAgICByZXF1aXJlZFRpZXI6IHVzZXJUaWVyID09PSAnZnJlZScgPyAncHJvJyA6ICdlbnRlcnByaXNlJyxcbiAgICAgICAgICB1cGdyYWRlTWVzc2FnZTogYFVwZ3JhZGUgdG8gJHt1c2VyVGllciA9PT0gJ2ZyZWUnID8gJ1BybycgOiAnRW50ZXJwcmlzZSd9IGZvciBoaWdoZXIgbGltaXRzYCxcbiAgICAgICAgICBsaW1pdGF0aW9uczogdmlvbGF0aW9uc1xuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBhbGxvd2VkOiB0cnVlLFxuICAgICAgICBjdXJyZW50VGllcjogdXNlclRpZXIsXG4gICAgICAgIGxpbWl0YXRpb25zXG4gICAgICB9O1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGFsbG93ZWQ6IGZhbHNlLFxuICAgICAgICByZWFzb246IGBWYWxpZGF0aW9uIGVycm9yOiAke2Vycm9yLm1lc3NhZ2V9YCxcbiAgICAgICAgY3VycmVudFRpZXI6ICdmcmVlJ1xuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGUgZXhwb3J0IGFjY2VzcyBhbmQgZm9ybWF0XG4gICAqL1xuICBwdWJsaWMgYXN5bmMgdmFsaWRhdGVFeHBvcnRBY2Nlc3ModXNlcklkOiBzdHJpbmcsIGZvcm1hdElkOiBzdHJpbmcsIHJlc29sdXRpb24/OiBudW1iZXIpOiBQcm9taXNlPEVuZm9yY2VtZW50UmVzdWx0PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHVzZXJUaWVyID0gYXdhaXQgdGhpcy5nZXRVc2VyVGllcih1c2VySWQpO1xuICAgICAgY29uc3QgbGltaXRzID0gVGllckVuZm9yY2VyLlRJRVJfTElNSVRTW3VzZXJUaWVyXTtcbiAgICAgIGNvbnN0IGZvcm1hdCA9IFRpZXJFbmZvcmNlci5FWFBPUlRfRk9STUFUU1tmb3JtYXRJZF07XG5cbiAgICAgIGlmICghZm9ybWF0KSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgYWxsb3dlZDogZmFsc2UsXG4gICAgICAgICAgcmVhc29uOiBgVW5rbm93biBleHBvcnQgZm9ybWF0OiAke2Zvcm1hdElkfWAsXG4gICAgICAgICAgY3VycmVudFRpZXI6IHVzZXJUaWVyXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIGlmIGZvcm1hdCBpcyBhbGxvd2VkIGZvciB1c2VyIHRpZXJcbiAgICAgIGlmICghbGltaXRzLmFsbG93ZWRFeHBvcnRGb3JtYXRzLmluY2x1ZGVzKGZvcm1hdElkKSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGFsbG93ZWQ6IGZhbHNlLFxuICAgICAgICAgIHJlYXNvbjogYEV4cG9ydCBmb3JtYXQgJyR7Zm9ybWF0Lm5hbWV9JyByZXF1aXJlcyAke2Zvcm1hdC5yZXF1aXJlZFRpZXJ9IHRpZXJgLFxuICAgICAgICAgIGN1cnJlbnRUaWVyOiB1c2VyVGllcixcbiAgICAgICAgICByZXF1aXJlZFRpZXI6IGZvcm1hdC5yZXF1aXJlZFRpZXIsXG4gICAgICAgICAgdXBncmFkZU1lc3NhZ2U6IGBVcGdyYWRlIHRvICR7Zm9ybWF0LnJlcXVpcmVkVGllcn0gZm9yICR7Zm9ybWF0Lm5hbWV9IGV4cG9ydGAsXG4gICAgICAgICAgbGltaXRhdGlvbnM6IFtgQXZhaWxhYmxlIGZvcm1hdHM6ICR7bGltaXRzLmFsbG93ZWRFeHBvcnRGb3JtYXRzLmpvaW4oJywgJyl9YF1cbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgcmVzb2x1dGlvbiBsaW1pdHNcbiAgICAgIGlmIChyZXNvbHV0aW9uICYmIHJlc29sdXRpb24gPiBsaW1pdHMubWF4RXhwb3J0UmVzb2x1dGlvbikge1xuICAgICAgICAvLyBEZXRlcm1pbmUgcmVxdWlyZWQgdGllciBiYXNlZCBvbiByZXNvbHV0aW9uXG4gICAgICAgIGxldCByZXF1aXJlZFRpZXI6IFVzZXJUaWVyID0gJ2ZyZWUnO1xuICAgICAgICBpZiAocmVzb2x1dGlvbiA+IDQzMjApIHtcbiAgICAgICAgICByZXF1aXJlZFRpZXIgPSAnZW50ZXJwcmlzZSc7XG4gICAgICAgIH0gZWxzZSBpZiAocmVzb2x1dGlvbiA+IDEwODApIHtcbiAgICAgICAgICByZXF1aXJlZFRpZXIgPSAncHJvJztcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgYWxsb3dlZDogZmFsc2UsXG4gICAgICAgICAgcmVhc29uOiBgUmVzb2x1dGlvbiAke3Jlc29sdXRpb259cCBleGNlZWRzIHRpZXIgbGltaXQgb2YgJHtsaW1pdHMubWF4RXhwb3J0UmVzb2x1dGlvbn1wYCxcbiAgICAgICAgICBjdXJyZW50VGllcjogdXNlclRpZXIsXG4gICAgICAgICAgcmVxdWlyZWRUaWVyLFxuICAgICAgICAgIHVwZ3JhZGVNZXNzYWdlOiBgVXBncmFkZSBmb3IgaGlnaGVyIHJlc29sdXRpb24gZXhwb3J0c2AsXG4gICAgICAgICAgbGltaXRhdGlvbnM6IFtgTWF4aW11bSByZXNvbHV0aW9uOiAke2xpbWl0cy5tYXhFeHBvcnRSZXNvbHV0aW9ufXBgXVxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICAvLyBDaGVjayBmZWF0dXJlIGZsYWdcbiAgICAgIGNvbnN0IGZlYXR1cmVFbmFibGVkID0gYXdhaXQgdGhpcy5mZWF0dXJlTWFuYWdlci5pc0VuYWJsZWQoZm9ybWF0LmZlYXR1cmVOYW1lLCB1c2VySWQpO1xuICAgICAgaWYgKCFmZWF0dXJlRW5hYmxlZC5lbmFibGVkKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgYWxsb3dlZDogZmFsc2UsXG4gICAgICAgICAgcmVhc29uOiBgRmVhdHVyZSAnJHtmb3JtYXQuZmVhdHVyZU5hbWV9JyBub3QgZW5hYmxlZCBmb3IgdXNlcmAsXG4gICAgICAgICAgY3VycmVudFRpZXI6IHVzZXJUaWVyLFxuICAgICAgICAgIHJlcXVpcmVkVGllcjogZm9ybWF0LnJlcXVpcmVkVGllclxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBhbGxvd2VkOiB0cnVlLFxuICAgICAgICBjdXJyZW50VGllcjogdXNlclRpZXIsXG4gICAgICAgIGxpbWl0YXRpb25zOiBsaW1pdHMud2F0ZXJtYXJrZWRFeHBvcnRzID8gWydFeHBvcnRzIHdpbGwgaW5jbHVkZSB3YXRlcm1hcmsnXSA6IFtdXG4gICAgICB9O1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGFsbG93ZWQ6IGZhbHNlLFxuICAgICAgICByZWFzb246IGBWYWxpZGF0aW9uIGVycm9yOiAke2Vycm9yLm1lc3NhZ2V9YCxcbiAgICAgICAgY3VycmVudFRpZXI6ICdmcmVlJ1xuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQXNzZXNzIGNhbGN1bGF0aW9uIGNvbXBsZXhpdHkgYW5kIHZhbGlkYXRlIHRpZXIgYWNjZXNzXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgdmFsaWRhdGVDYWxjdWxhdGlvbkFjY2Vzcyh1c2VySWQ6IHN0cmluZywgaW5wdXRzOiBEdWN0U2l6aW5nSW5wdXRzLCBwcm9qZWN0RGF0YT86IFBhcnRpYWw8UHJvamVjdERhdGE+KTogUHJvbWlzZTxFbmZvcmNlbWVudFJlc3VsdD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB1c2VyVGllciA9IGF3YWl0IHRoaXMuZ2V0VXNlclRpZXIodXNlcklkKTtcbiAgICAgIGNvbnN0IGxpbWl0cyA9IFRpZXJFbmZvcmNlci5USUVSX0xJTUlUU1t1c2VyVGllcl07XG5cbiAgICAgIC8vIEFzc2VzcyBjYWxjdWxhdGlvbiBjb21wbGV4aXR5XG4gICAgICBjb25zdCBjb21wbGV4aXR5ID0gdGhpcy5hc3Nlc3NDYWxjdWxhdGlvbkNvbXBsZXhpdHkoaW5wdXRzLCBwcm9qZWN0RGF0YSk7XG5cbiAgICAgIC8vIENoZWNrIGlmIHVzZXIgdGllciBzdXBwb3J0cyB0aGlzIGNvbXBsZXhpdHkgbGV2ZWxcbiAgICAgIGNvbnN0IGNvbXBsZXhpdHlMZXZlbHMgPSBbJ2Jhc2ljJywgJ2ludGVybWVkaWF0ZScsICdhZHZhbmNlZCcsICdleHBlcnQnXTtcbiAgICAgIGNvbnN0IHVzZXJNYXhMZXZlbCA9IGNvbXBsZXhpdHlMZXZlbHMuaW5kZXhPZihsaW1pdHMubWF4Q2FsY3VsYXRpb25Db21wbGV4aXR5KTtcbiAgICAgIGNvbnN0IHJlcXVpcmVkTGV2ZWwgPSBjb21wbGV4aXR5TGV2ZWxzLmluZGV4T2YoY29tcGxleGl0eS5sZXZlbCk7XG5cbiAgICAgIGlmIChyZXF1aXJlZExldmVsID4gdXNlck1heExldmVsKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgYWxsb3dlZDogZmFsc2UsXG4gICAgICAgICAgcmVhc29uOiBgQ2FsY3VsYXRpb24gY29tcGxleGl0eSAnJHtjb21wbGV4aXR5LmxldmVsfScgcmVxdWlyZXMgJHtjb21wbGV4aXR5LnJlcXVpcmVkVGllcn0gdGllcmAsXG4gICAgICAgICAgY3VycmVudFRpZXI6IHVzZXJUaWVyLFxuICAgICAgICAgIHJlcXVpcmVkVGllcjogY29tcGxleGl0eS5yZXF1aXJlZFRpZXIsXG4gICAgICAgICAgdXBncmFkZU1lc3NhZ2U6IGBVcGdyYWRlIHRvICR7Y29tcGxleGl0eS5yZXF1aXJlZFRpZXJ9IGZvciBhZHZhbmNlZCBjYWxjdWxhdGlvbnNgLFxuICAgICAgICAgIGxpbWl0YXRpb25zOiBbYEN1cnJlbnQgdGllciBzdXBwb3J0czogJHtsaW1pdHMubWF4Q2FsY3VsYXRpb25Db21wbGV4aXR5fSBjYWxjdWxhdGlvbnNgXVxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBhbGxvd2VkOiB0cnVlLFxuICAgICAgICBjdXJyZW50VGllcjogdXNlclRpZXIsXG4gICAgICAgIGxpbWl0YXRpb25zOiBbYENhbGN1bGF0aW9uIGNvbXBsZXhpdHk6ICR7Y29tcGxleGl0eS5sZXZlbH0gKHNjb3JlOiAke2NvbXBsZXhpdHkuc2NvcmV9KWBdXG4gICAgICB9O1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGFsbG93ZWQ6IGZhbHNlLFxuICAgICAgICByZWFzb246IGBWYWxpZGF0aW9uIGVycm9yOiAke2Vycm9yLm1lc3NhZ2V9YCxcbiAgICAgICAgY3VycmVudFRpZXI6ICdmcmVlJ1xuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGUgZmVhdHVyZSBhY2Nlc3NcbiAgICovXG4gIHB1YmxpYyBhc3luYyB2YWxpZGF0ZUZlYXR1cmVBY2Nlc3ModXNlcklkOiBzdHJpbmcsIGZlYXR1cmVOYW1lOiBzdHJpbmcpOiBQcm9taXNlPEVuZm9yY2VtZW50UmVzdWx0PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHVzZXJUaWVyID0gYXdhaXQgdGhpcy5nZXRVc2VyVGllcih1c2VySWQpO1xuICAgICAgY29uc3QgbGltaXRzID0gVGllckVuZm9yY2VyLlRJRVJfTElNSVRTW3VzZXJUaWVyXTtcblxuICAgICAgLy8gQ2hlY2sgZmVhdHVyZSBmbGFnXG4gICAgICBjb25zdCBmZWF0dXJlUmVzdWx0ID0gYXdhaXQgdGhpcy5mZWF0dXJlTWFuYWdlci5pc0VuYWJsZWQoZmVhdHVyZU5hbWUsIHVzZXJJZCk7XG5cbiAgICAgIGlmICghZmVhdHVyZVJlc3VsdC5lbmFibGVkKSB7XG4gICAgICAgIC8vIERldGVybWluZSByZXF1aXJlZCB0aWVyIGZvciB0aGlzIGZlYXR1cmVcbiAgICAgICAgbGV0IHJlcXVpcmVkVGllcjogVXNlclRpZXIgPSAncHJvJztcbiAgICAgICAgZm9yIChjb25zdCBbdGllciwgdGllckxpbWl0c10gb2YgT2JqZWN0LmVudHJpZXMoVGllckVuZm9yY2VyLlRJRVJfTElNSVRTKSkge1xuICAgICAgICAgIGlmICh0aWVyTGltaXRzLmFkdmFuY2VkRmVhdHVyZXMuaW5jbHVkZXMoZmVhdHVyZU5hbWUpKSB7XG4gICAgICAgICAgICByZXF1aXJlZFRpZXIgPSB0aWVyIGFzIFVzZXJUaWVyO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBhbGxvd2VkOiBmYWxzZSxcbiAgICAgICAgICByZWFzb246IGZlYXR1cmVSZXN1bHQucmVhc29uIHx8IGBGZWF0dXJlICcke2ZlYXR1cmVOYW1lfScgbm90IGF2YWlsYWJsZWAsXG4gICAgICAgICAgY3VycmVudFRpZXI6IHVzZXJUaWVyLFxuICAgICAgICAgIHJlcXVpcmVkVGllcixcbiAgICAgICAgICB1cGdyYWRlTWVzc2FnZTogYFVwZ3JhZGUgdG8gJHtyZXF1aXJlZFRpZXJ9IGZvciAke2ZlYXR1cmVOYW1lfWAsXG4gICAgICAgICAgbGltaXRhdGlvbnM6IFtgQXZhaWxhYmxlIGZlYXR1cmVzOiAke2xpbWl0cy5hZHZhbmNlZEZlYXR1cmVzLmpvaW4oJywgJykgfHwgJ0Jhc2ljIGZlYXR1cmVzIG9ubHknfWBdXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGFsbG93ZWQ6IHRydWUsXG4gICAgICAgIGN1cnJlbnRUaWVyOiB1c2VyVGllclxuICAgICAgfTtcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBhbGxvd2VkOiBmYWxzZSxcbiAgICAgICAgcmVhc29uOiBgVmFsaWRhdGlvbiBlcnJvcjogJHtlcnJvci5tZXNzYWdlfWAsXG4gICAgICAgIGN1cnJlbnRUaWVyOiAnZnJlZSdcbiAgICAgIH07XG4gICAgfVxuICB9XG5cblxuICAvKipcbiAgICogVmFsaWRhdGUgZ2VuZXJpYyBmaWxlIGFjY2VzcyBiYXNlZCBvbiB0aWVyIChyZWFkL3dyaXRlKVxuICAgKiBOb24tZGVzdHJ1Y3RpdmUgYWRkaXRpdmUgbWV0aG9kIHRvIGFsaWduIHdpdGggRWxlY3Ryb24gRmlsZU1hbmFnZXIgdXNhZ2VcbiAgICovXG4gIHB1YmxpYyBhc3luYyB2YWxpZGF0ZUZpbGVBY2Nlc3ModXNlcklkOiBzdHJpbmcsIG1vZGU6ICdyZWFkJyB8ICd3cml0ZScpOiBQcm9taXNlPEVuZm9yY2VtZW50UmVzdWx0PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHVzZXJUaWVyID0gYXdhaXQgdGhpcy5nZXRVc2VyVGllcih1c2VySWQpO1xuICAgICAgLy8gRm9yIG5vdywgYWxsb3cgYm90aCByZWFkIGFuZCB3cml0ZSBmb3IgZnJlZSB0aWVyLCBhbGlnbiB3aXRoIGZlYXR1cmUgZmxhZ3MgbGF0ZXJcbiAgICAgIHJldHVybiB7IGFsbG93ZWQ6IHRydWUsIGN1cnJlbnRUaWVyOiB1c2VyVGllciB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4geyBhbGxvd2VkOiBmYWxzZSwgY3VycmVudFRpZXI6ICdmcmVlJywgcmVhc29uOiBgVmFsaWRhdGlvbiBlcnJvcjogJHtlcnJvci5tZXNzYWdlfWAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGUgaW1wb3J0IGFjY2VzcyBiYXNlZCBvbiBmaWxlIGV4dGVuc2lvbiBhbmQgc2l6ZVxuICAgKiBBbGlnbnMgd2l0aCBGaWxlTWFuYWdlci5pbXBvcnRQcm9qZWN0IHVzYWdlOyB1c2VzIGV4cG9ydCBsaW1pdHMgaGV1cmlzdGljYWxseVxuICAgKi9cbiAgcHVibGljIGFzeW5jIHZhbGlkYXRlSW1wb3J0QWNjZXNzKHVzZXJJZDogc3RyaW5nLCBleHRlbnNpb246IHN0cmluZywgc2l6ZUJ5dGVzPzogbnVtYmVyKTogUHJvbWlzZTxFbmZvcmNlbWVudFJlc3VsdD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB1c2VyVGllciA9IGF3YWl0IHRoaXMuZ2V0VXNlclRpZXIodXNlcklkKTtcbiAgICAgIGNvbnN0IGxpbWl0cyA9IFRpZXJFbmZvcmNlci5USUVSX0xJTUlUU1t1c2VyVGllcl07XG4gICAgICAvLyBCYXNpYyBzaXplIGdhdGluZyBzaW1pbGFyIHRvIEZpbGVNYW5hZ2VyXG4gICAgICBjb25zdCBzaXplTGltaXQgPSB1c2VyVGllciA9PT0gJ2ZyZWUnID8gMTAgKiAxMDI0ICogMTAyNCA6IHVzZXJUaWVyID09PSAncHJvJyA/IDEwMCAqIDEwMjQgKiAxMDI0IDogMTAyNCAqIDEwMjQgKiAxMDI0O1xuICAgICAgaWYgKHNpemVCeXRlcyAmJiBzaXplQnl0ZXMgPiBzaXplTGltaXQpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBhbGxvd2VkOiBmYWxzZSxcbiAgICAgICAgICBjdXJyZW50VGllcjogdXNlclRpZXIsXG4gICAgICAgICAgcmVhc29uOiBgSW1wb3J0IHNpemUgZXhjZWVkcyB0aWVyIGxpbWl0YCxcbiAgICAgICAgICByZXF1aXJlZFRpZXI6IHNpemVCeXRlcyA+IDEwMCAqIDEwMjQgKiAxMDI0ID8gJ2VudGVycHJpc2UnIDogJ3BybydcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7IGFsbG93ZWQ6IHRydWUsIGN1cnJlbnRUaWVyOiB1c2VyVGllciB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4geyBhbGxvd2VkOiBmYWxzZSwgY3VycmVudFRpZXI6ICdmcmVlJywgcmVhc29uOiBgVmFsaWRhdGlvbiBlcnJvcjogJHtlcnJvci5tZXNzYWdlfWAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUGVyZm9ybSBjYWxjdWxhdGlvbiB3aXRoIHRpZXIgZW5mb3JjZW1lbnRcbiAgICovXG4gIHB1YmxpYyBhc3luYyBwZXJmb3JtQ2FsY3VsYXRpb24odXNlcklkOiBzdHJpbmcsIGlucHV0czogRHVjdFNpemluZ0lucHV0cywgcHJvamVjdERhdGE/OiBQYXJ0aWFsPFByb2plY3REYXRhPik6IFByb21pc2U8e1xuICAgIHJlc3VsdD86IER1Y3RTaXppbmdSZXN1bHRzO1xuICAgIHZhbGlkYXRpb24/OiBWYWxpZGF0aW9uUmVzdWx0O1xuICAgIGVuZm9yY2VtZW50OiBFbmZvcmNlbWVudFJlc3VsdDtcbiAgfT4ge1xuICAgIC8vIFZhbGlkYXRlIGNhbGN1bGF0aW9uIGFjY2Vzc1xuICAgIGNvbnN0IGVuZm9yY2VtZW50ID0gYXdhaXQgdGhpcy52YWxpZGF0ZUNhbGN1bGF0aW9uQWNjZXNzKHVzZXJJZCwgaW5wdXRzLCBwcm9qZWN0RGF0YSk7XG5cbiAgICBpZiAoIWVuZm9yY2VtZW50LmFsbG93ZWQpIHtcbiAgICAgIHJldHVybiB7IGVuZm9yY2VtZW50IH07XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIC8vIFBlcmZvcm0gY2FsY3VsYXRpb24gdXNpbmcgZXh0cmFjdGVkIGNvcmUgbG9naWNcbiAgICAgIGNvbnN0IHJlc3VsdCA9IEFpckR1Y3RDYWxjdWxhdG9yLmNhbGN1bGF0ZUR1Y3RTaXppbmcoaW5wdXRzKTtcblxuICAgICAgLy8gVmFsaWRhdGUgYWdhaW5zdCBzdGFuZGFyZHNcbiAgICAgIGNvbnN0IGNhbGN1bGF0aW9uRGF0YTogQ2FsY3VsYXRpb25EYXRhID0ge1xuICAgICAgICB2ZWxvY2l0eTogcmVzdWx0LnZlbG9jaXR5LFxuICAgICAgICBmcmljdGlvblJhdGU6IGlucHV0cy5mcmljdGlvblJhdGUsXG4gICAgICAgIGR1Y3RUeXBlOiBpbnB1dHMuZHVjdFR5cGUsXG4gICAgICAgIGFpcmZsb3c6IGlucHV0cy5haXJmbG93LFxuICAgICAgICBkaWFtZXRlcjogcmVzdWx0LmRpYW1ldGVyLFxuICAgICAgICB3aWR0aDogcmVzdWx0LndpZHRoLFxuICAgICAgICBoZWlnaHQ6IHJlc3VsdC5oZWlnaHQsXG4gICAgICAgIGFzcGVjdFJhdGlvOiByZXN1bHQuYXNwZWN0UmF0aW8sXG4gICAgICAgIGFyZWE6IHJlc3VsdC5hcmVhLFxuICAgICAgICBtYXRlcmlhbDogaW5wdXRzLm1hdGVyaWFsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCB2YWxpZGF0aW9uID0gU01BQ05BVmFsaWRhdG9yLnZhbGlkYXRlU01BQ05BQ29tcGxpYW5jZShjYWxjdWxhdGlvbkRhdGEpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICByZXN1bHQsXG4gICAgICAgIHZhbGlkYXRpb24sXG4gICAgICAgIGVuZm9yY2VtZW50XG4gICAgICB9O1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGVuZm9yY2VtZW50OiB7XG4gICAgICAgICAgYWxsb3dlZDogZmFsc2UsXG4gICAgICAgICAgcmVhc29uOiBgQ2FsY3VsYXRpb24gZXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gLFxuICAgICAgICAgIGN1cnJlbnRUaWVyOiBlbmZvcmNlbWVudC5jdXJyZW50VGllclxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBc3Nlc3MgY2FsY3VsYXRpb24gY29tcGxleGl0eSBiYXNlZCBvbiBpbnB1dHMgYW5kIHByb2plY3QgZGF0YVxuICAgKi9cbiAgcHJpdmF0ZSBhc3Nlc3NDYWxjdWxhdGlvbkNvbXBsZXhpdHkoaW5wdXRzOiBEdWN0U2l6aW5nSW5wdXRzLCBwcm9qZWN0RGF0YT86IFBhcnRpYWw8UHJvamVjdERhdGE+KTogQ2FsY3VsYXRpb25Db21wbGV4aXR5IHtcbiAgICBsZXQgc2NvcmUgPSAwO1xuICAgIGNvbnN0IGZhY3RvcnMgPSB7XG4gICAgICBzZWdtZW50Q291bnQ6IHByb2plY3REYXRhPy5zZWdtZW50cz8ubGVuZ3RoIHx8IDEsXG4gICAgICByb29tQ291bnQ6IHByb2plY3REYXRhPy5yb29tcz8ubGVuZ3RoIHx8IDEsXG4gICAgICBlcXVpcG1lbnRDb3VudDogcHJvamVjdERhdGE/LmVxdWlwbWVudD8ubGVuZ3RoIHx8IDEsXG4gICAgICBjdXN0b21NYXRlcmlhbHM6IGlucHV0cy5tYXRlcmlhbCAmJiBpbnB1dHMubWF0ZXJpYWwgIT09ICdnYWx2YW5pemVkX3N0ZWVsJyA/IDEgOiAwLFxuICAgICAgYWR2YW5jZWRGZWF0dXJlczogMFxuICAgIH07XG5cbiAgICAvLyBTY29yZSBiYXNlZCBvbiBwcm9qZWN0IHNpemVcbiAgICBzY29yZSArPSBNYXRoLm1pbihmYWN0b3JzLnNlZ21lbnRDb3VudCAqIDIsIDIwKTtcbiAgICBzY29yZSArPSBNYXRoLm1pbihmYWN0b3JzLnJvb21Db3VudCAqIDMsIDE1KTtcbiAgICBzY29yZSArPSBNYXRoLm1pbihmYWN0b3JzLmVxdWlwbWVudENvdW50ICogNCwgMjApO1xuXG4gICAgLy8gU2NvcmUgYmFzZWQgb24gY2FsY3VsYXRpb24gcGFyYW1ldGVyc1xuICAgIGlmIChpbnB1dHMuZnJpY3Rpb25SYXRlID4gMC4xMikgc2NvcmUgKz0gMTA7IC8vIEhpZ2ggZnJpY3Rpb24gcmF0ZVxuICAgIGlmIChpbnB1dHMudGFyZ2V0VmVsb2NpdHkgJiYgaW5wdXRzLnRhcmdldFZlbG9jaXR5ID4gMjAwMCkgc2NvcmUgKz0gMTA7IC8vIEhpZ2ggdmVsb2NpdHlcbiAgICBpZiAoaW5wdXRzLmR1Y3RUeXBlID09PSAncmVjdGFuZ3VsYXInKSBzY29yZSArPSA1OyAvLyBNb3JlIGNvbXBsZXggdGhhbiByb3VuZFxuXG4gICAgLy8gU2NvcmUgYmFzZWQgb24gY3VzdG9tIG1hdGVyaWFsc1xuICAgIHNjb3JlICs9IGZhY3RvcnMuY3VzdG9tTWF0ZXJpYWxzICogMTA7XG5cbiAgICAvLyBEZXRlcm1pbmUgY29tcGxleGl0eSBsZXZlbCBhbmQgcmVxdWlyZWQgdGllclxuICAgIGxldCBsZXZlbDogQ2FsY3VsYXRpb25Db21wbGV4aXR5WydsZXZlbCddO1xuICAgIGxldCByZXF1aXJlZFRpZXI6IFVzZXJUaWVyO1xuXG4gICAgaWYgKHNjb3JlIDw9IDI1KSB7XG4gICAgICBsZXZlbCA9ICdiYXNpYyc7XG4gICAgICByZXF1aXJlZFRpZXIgPSAnZnJlZSc7XG4gICAgfSBlbHNlIGlmIChzY29yZSA8PSA1MCkge1xuICAgICAgbGV2ZWwgPSAnaW50ZXJtZWRpYXRlJztcbiAgICAgIHJlcXVpcmVkVGllciA9ICdwcm8nO1xuICAgIH0gZWxzZSBpZiAoc2NvcmUgPD0gNzUpIHtcbiAgICAgIGxldmVsID0gJ2FkdmFuY2VkJztcbiAgICAgIHJlcXVpcmVkVGllciA9ICdwcm8nO1xuICAgIH0gZWxzZSB7XG4gICAgICBsZXZlbCA9ICdleHBlcnQnO1xuICAgICAgcmVxdWlyZWRUaWVyID0gJ2VudGVycHJpc2UnO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBsZXZlbCxcbiAgICAgIHNjb3JlOiBNYXRoLm1pbihzY29yZSwgMTAwKSxcbiAgICAgIGZhY3RvcnMsXG4gICAgICByZXF1aXJlZFRpZXJcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB1c2VyIHRpZXIgZnJvbSBmZWF0dXJlIG1hbmFnZXJcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZ2V0VXNlclRpZXIodXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPFVzZXJUaWVyPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIEdldCB1c2VyIGZyb20gZGF0YWJhc2UgdGhyb3VnaCBmZWF0dXJlIG1hbmFnZXJcbiAgICAgIGNvbnN0IHVzZXJSZXBvID0gdGhpcy5mZWF0dXJlTWFuYWdlclsndXNlclJlcG9zaXRvcnknXTtcbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCB1c2VyUmVwby5nZXRVc2VyKHVzZXJJZCk7XG4gICAgICByZXR1cm4gdXNlcj8udGllciB8fCAnZnJlZSc7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgdXNlciB0aWVyOicsIGVycm9yKTtcbiAgICAgIHJldHVybiAnZnJlZSc7IC8vIERlZmF1bHQgdG8gZnJlZSB0aWVyIG9uIGVycm9yXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCB1c2VyIHByb2plY3QgY291bnRcbiAgICogVE9ETzogSW1wbGVtZW50IGFjdHVhbCBwcm9qZWN0IGNvdW50IHF1ZXJ5IHdoZW4gcHJvamVjdCByZXBvc2l0b3J5IGlzIGF2YWlsYWJsZVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBnZXRVc2VyUHJvamVjdENvdW50KHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICAvLyBUaGlzIHdvdWxkIHR5cGljYWxseSBxdWVyeSB0aGUgcHJvamVjdHMgdGFibGUgdGhyb3VnaCBhIHJlcG9zaXRvcnlcbiAgICAvLyBGb3Igbm93LCByZXR1cm4gMCBhcyBwbGFjZWhvbGRlciB1bnRpbCBwcm9qZWN0IHJlcG9zaXRvcnkgaXMgaW1wbGVtZW50ZWRcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKDApO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aWVyIGxpbWl0cyBmb3IgYSBzcGVjaWZpYyB0aWVyXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGdldFRpZXJMaW1pdHModGllcjogVXNlclRpZXIpOiBUaWVyTGltaXRzIHtcbiAgICByZXR1cm4geyAuLi5UaWVyRW5mb3JjZXIuVElFUl9MSU1JVFNbdGllcl0gfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYWxsIGV4cG9ydCBmb3JtYXRzXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGdldEV4cG9ydEZvcm1hdHMoKTogUmVjb3JkPHN0cmluZywgRXhwb3J0Rm9ybWF0PiB7XG4gICAgcmV0dXJuIHsgLi4uVGllckVuZm9yY2VyLkVYUE9SVF9GT1JNQVRTIH07XG4gIH1cblxuICAvKipcbiAgICogR2V0IGV4cG9ydCBmb3JtYXRzIGF2YWlsYWJsZSBmb3IgYSB0aWVyXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGdldEF2YWlsYWJsZUV4cG9ydEZvcm1hdHModGllcjogVXNlclRpZXIpOiBFeHBvcnRGb3JtYXRbXSB7XG4gICAgY29uc3QgbGltaXRzID0gVGllckVuZm9yY2VyLlRJRVJfTElNSVRTW3RpZXJdO1xuICAgIHJldHVybiBsaW1pdHMuYWxsb3dlZEV4cG9ydEZvcm1hdHMubWFwKGlkID0+IFRpZXJFbmZvcmNlci5FWFBPUlRfRk9STUFUU1tpZF0pLmZpbHRlcihCb29sZWFuKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBUaWVyRW5mb3JjZXI7XG4iXSwidmVyc2lvbiI6M30=